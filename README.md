# CoDoC
**Co**de and **Doc**umentation Based Classification of Sources and Sinks.

In this repository, one can find relevant information about our approach to automatically classify Android sources and sinks.
All the artefacts necessary to reproduce our study can be found here.

## Getting started

### Downloading the tool

<pre>
git clone https://github.com/JordanSamhi/CoDoC.git
</pre>

### Installing the tool

<pre>
cd CoDoC
mvn clean install
</pre>

### Using the tool

#### Extracting source code and documentation from android sources:

<pre>
java -jar CoDoC/target/CoDoC-0.0.1-SNAPSHOT-jar-with-dependencies.jar <i>options</i>
</pre>

Options:

* ```-c``` : Extract source code.
* ```-d``` : Extract documentation.
* ```-o``` : Destination folder for files.
* ```-s``` : Source folder.

Resulting files will be stored in path given with ```-o``` option in two separate folders **source_code** and **documentation**.

#### Generating documentation vectors using sentenceBERT:

<pre>
python3 vectorize_documentation_using_sentence_bert.py EXTRACTED_SOURCE_FOLDER
</pre>

Resulting vectors will be stored in current directory in file named documentation_vectors.txt.

#### Generating source code vectors using code2vec:

Copy source code folder generated by CoDoC you want to analyze in artefacts/code2vec/android_source/
<pre>
cp -r OUTPUT_PATH_SOURCE artefacts/code2vec/android_source/
</pre>

Build JavaExtractor tool
<pre>
cd artefacts/code2vec/JavaExtractor/JPredict/
mvn clean install
</pre>

Prepare datasets for code2vec
<pre>
cd ../../android_source/
mkdir android_source_train android_source_val android_source_test
count_src=$(ls -1|grep -v android|wc -l)
five_percent=$((count_src * 5 / 100))
ls -1 |grep -v "android"|head -$five_percent|parallel -j24 mv {} android_source_val/{}.java
ls -1 |grep -v "android"|head -$five_percent|parallel -j24 mv {} android_source_test/{}.java
ls -1 |grep -v "android"|parallel -j24 mv {} android_source_train/{}.java
cd ../
</pre>

Preprocess the data
<pre>
sh preprocess.sh
</pre>

Train the dataset
<pre>
sh train.sh
</pre>

Generate the source code vectors
<pre>
python3 code2vector_infer.py -o OUTPUT
</pre>

Vectors will be available in OUTPUT/source_code_vectors.txt

### Run everything at once

If you want to launch everything at once, you can just use this script:
<pre>
./launch_codoc.sh -s PATH_TO_ANDROID_SOURCE -o OUTPUT_PATH
</pre>

## Built With

* [Maven](https://maven.apache.org/) - Dependency Management

## License

This project is licensed under the GNU GENERAL PUBLIC LICENSE Version 3 - see the [LICENSE](LICENSE) file for details

## Contact

For any question regarding this study, please contact us at:
[Jordan Samhi](mailto:jordan.samhi@uni.lu)
