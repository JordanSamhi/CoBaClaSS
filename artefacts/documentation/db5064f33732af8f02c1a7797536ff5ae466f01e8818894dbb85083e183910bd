
     * Wait until the desired state is observed, checking all state
     * transitions since the last time a state was waited on.
     *
     * <p>Any intermediate state transitions that is not {@code state} are ignored.</p>
     *
     * <p>Note: Only one waiter allowed at a time!</p>
     *
     * @param state state to observe a transition to
     * @param timeoutMs how long to wait in milliseconds
     *
     * @throws IllegalArgumentException if {@code state} was out of range
     * @throws TimeoutRuntimeException if the desired state is not observed before timeout.
     * @throws IllegalStateException if another thread is already waiting for a state transition
     