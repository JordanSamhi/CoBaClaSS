public static byte[] readAll(InputStream inputStream) throws IOException{
    ByteArrayOutputStream combinedBuffer = new ByteArrayOutputStream();
    byte[] buffer = new byte[16 * 1024];
    while (true) {
        int numRead = inputStream.read(buffer);
        if (numRead == -1) {
            break;
        }
        combinedBuffer.write(buffer, 0, numRead);
    }
    return combinedBuffer.toByteArray();
}