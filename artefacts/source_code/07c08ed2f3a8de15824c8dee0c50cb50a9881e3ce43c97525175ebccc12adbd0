public int getDesiredHeight(){
    if (mQSCustomizer.isCustomizing()) {
        return getView().getHeight();
    }
    if (mQSDetail.isClosingDetail()) {
        LayoutParams layoutParams = (LayoutParams) mQSPanelScrollView.getLayoutParams();
        int panelHeight = layoutParams.topMargin + layoutParams.bottomMargin + +mQSPanelScrollView.getMeasuredHeight();
        return panelHeight + getView().getPaddingBottom();
    } else {
        return getView().getMeasuredHeight();
    }
}