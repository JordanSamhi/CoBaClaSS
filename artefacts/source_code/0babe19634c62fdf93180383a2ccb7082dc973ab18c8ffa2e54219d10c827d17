public PlatformDecryptionKey getDecryptKey(int userId) throws KeyStoreException, UnrecoverableKeyException, NoSuchAlgorithmException, IOException, RemoteException{
    init(userId);
    try {
        PlatformDecryptionKey decryptionKey = getDecryptKeyInternal(userId);
        ensureDecryptionKeyIsValid(userId, decryptionKey);
        return decryptionKey;
    } catch (UnrecoverableKeyException e) {
        Log.i(TAG, String.format(Locale.US, "Regenerating permanently invalid Platform key for user %d.", userId));
        regenerate(userId);
        return getDecryptKeyInternal(userId);
    }
}