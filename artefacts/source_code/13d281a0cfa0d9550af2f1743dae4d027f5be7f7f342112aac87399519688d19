public static void writeToXml(XmlSerializer out, IpConfiguration ipConfiguration) throws XmlPullParserException, IOException{
    XmlUtil.writeNextValue(out, XML_TAG_IP_ASSIGNMENT, ipConfiguration.getIpAssignment().toString());
    switch(ipConfiguration.getIpAssignment()) {
        case STATIC:
            writeStaticIpConfigurationToXml(out, ipConfiguration.getStaticIpConfiguration());
            break;
        case DHCP:
        case UNASSIGNED:
            break;
        default:
            Log.w(TAG, "Ignoring unknown ip assignment type: " + ipConfiguration.getIpAssignment());
            break;
    }
    XmlUtil.writeNextValue(out, XML_TAG_PROXY_SETTINGS, ipConfiguration.getProxySettings().toString());
    switch(ipConfiguration.getProxySettings()) {
        case STATIC:
            XmlUtil.writeNextValue(out, XML_TAG_PROXY_HOST, ipConfiguration.getHttpProxy().getHost());
            XmlUtil.writeNextValue(out, XML_TAG_PROXY_PORT, ipConfiguration.getHttpProxy().getPort());
            XmlUtil.writeNextValue(out, XML_TAG_PROXY_EXCLUSION_LIST, generateProxyExclusionListString(ipConfiguration.getHttpProxy().getExclusionList()));
            break;
        case PAC:
            XmlUtil.writeNextValue(out, XML_TAG_PROXY_PAC_FILE, ipConfiguration.getHttpProxy().getPacFileUrl().toString());
            break;
        case NONE:
        case UNASSIGNED:
            break;
        default:
            Log.w(TAG, "Ignoring unknown proxy settings type: " + ipConfiguration.getProxySettings());
            break;
    }
}