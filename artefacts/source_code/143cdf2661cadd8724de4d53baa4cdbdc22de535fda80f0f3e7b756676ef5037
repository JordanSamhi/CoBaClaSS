public static int findNextUnicodePosition(int currentPosition, int byteLimit, CharSequence msgBody){
    int nextPos = Math.min(currentPosition + byteLimit / 2, msgBody.length());
    if (nextPos < msgBody.length()) {
        BreakIterator breakIterator = BreakIterator.getCharacterInstance();
        breakIterator.setText(msgBody.toString());
        if (!breakIterator.isBoundary(nextPos)) {
            int breakPos = breakIterator.preceding(nextPos);
            while (breakPos + 4 <= nextPos && isRegionalIndicatorSymbol(Character.codePointAt(msgBody, breakPos)) && isRegionalIndicatorSymbol(Character.codePointAt(msgBody, breakPos + 2))) {
                breakPos += 4;
            }
            if (breakPos > currentPosition) {
                nextPos = breakPos;
            } else if (Character.isHighSurrogate(msgBody.charAt(nextPos - 1))) {
                nextPos -= 1;
            }
        }
    }
    return nextPos;
}