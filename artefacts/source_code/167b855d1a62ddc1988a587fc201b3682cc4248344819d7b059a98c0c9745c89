public void setPrimaryToolbarButtonFlat(boolean isFlat){
    if (isFlat == mPrimaryToolbarButtonFlat) {
        return;
    }
    Button newPrimaryButton = createPrimaryToolbarButton(isFlat);
    ViewGroup parent = (ViewGroup) findViewById(R.id.button_container);
    int buttonIndex = parent.indexOfChild(mPrimaryToolbarButton);
    parent.removeViewAt(buttonIndex);
    parent.addView(newPrimaryButton, buttonIndex);
    setPrimaryToolbarButton(newPrimaryButton);
    mPrimaryToolbarButtonFlat = isFlat;
}