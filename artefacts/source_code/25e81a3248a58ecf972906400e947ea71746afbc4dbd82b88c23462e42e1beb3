public static IPAddressTypeAvailabilityElement parse(ByteBuffer payload) throws ProtocolException{
    if (payload.remaining() != EXPECTED_BUFFER_LENGTH) {
        throw new ProtocolException("Unexpected buffer length: " + payload.remaining());
    }
    int ipField = payload.get() & 0xFF;
    int v6Availability = ipField & IPV6_AVAILABILITY_MASK;
    if (!IPV6_AVAILABILITY.contains(v6Availability)) {
        v6Availability = IPV6_UNKNOWN;
    }
    int v4Availability = (ipField >> 2) & IPV4_AVAILABILITY_MASK;
    if (!IPV4_AVAILABILITY.contains(v4Availability)) {
        v4Availability = IPV4_UNKNOWN;
    }
    return new IPAddressTypeAvailabilityElement(v4Availability, v6Availability);
}