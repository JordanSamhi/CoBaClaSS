public static java.security.KeyStore getKeyStoreForUid(int uid) throws KeyStoreException, NoSuchProviderException{
    java.security.KeyStore result = java.security.KeyStore.getInstance("AndroidKeyStore", PROVIDER_NAME);
    try {
        result.load(new AndroidKeyStoreLoadStoreParameter(uid));
    } catch (NoSuchAlgorithmException | CertificateException | IOException e) {
        throw new KeyStoreException("Failed to load AndroidKeyStore KeyStore for UID " + uid, e);
    }
    return result;
}