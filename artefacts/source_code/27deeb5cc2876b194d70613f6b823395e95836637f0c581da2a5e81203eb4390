public boolean equals(Object o, boolean excludingCaptionInsets, boolean excludeInvisibleImeFrames){
    if (this == o) {
        return true;
    }
    if (o == null || getClass() != o.getClass()) {
        return false;
    }
    InsetsState state = (InsetsState) o;
    if (!mDisplayFrame.equals(state.mDisplayFrame)) {
        return false;
    }
    for (int i = 0; i < SIZE; i++) {
        if (excludingCaptionInsets) {
            if (i == ITYPE_CAPTION_BAR)
                continue;
        }
        InsetsSource source = mSources[i];
        InsetsSource otherSource = state.mSources[i];
        if (source == null && otherSource == null) {
            continue;
        }
        if (source != null && otherSource == null || source == null && otherSource != null) {
            return false;
        }
        if (!otherSource.equals(source, excludeInvisibleImeFrames)) {
            return false;
        }
    }
    return true;
}