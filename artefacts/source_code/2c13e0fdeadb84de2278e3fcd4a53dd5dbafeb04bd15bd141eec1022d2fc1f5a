public void terminate(){
    synchronized (mLock) {
        final long waitForDeathCookie = new Random().nextLong();
        final CountDownLatch waitForDeathLatch = new CountDownLatch(1);
        linkToSupplicantDeath((cookie) -> {
            Log.d(TAG, "ISupplicant died: cookie=" + cookie);
            if (cookie != waitForDeathCookie)
                return;
            waitForDeathLatch.countDown();
        }, waitForDeathCookie);
        if (isV1_1()) {
            Log.i(TAG, "Terminating supplicant using HIDL");
            terminate_V1_1();
        } else {
            Log.i(TAG, "Terminating supplicant using init");
            mFrameworkFacade.stopSupplicant();
        }
        try {
            if (!waitForDeathLatch.await(WAIT_FOR_DEATH_TIMEOUT_MS, TimeUnit.MILLISECONDS)) {
                Log.w(TAG, "Timed out waiting for confirmation of supplicant death");
            }
        } catch (InterruptedException e) {
            Log.w(TAG, "Failed to wait for supplicant death");
        }
    }
}