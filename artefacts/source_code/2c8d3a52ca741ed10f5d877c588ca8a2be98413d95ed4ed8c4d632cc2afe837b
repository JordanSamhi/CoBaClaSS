public boolean hasRestrictedRequests(boolean excludeDun){
    synchronized (mRefCountLock) {
        for (NetworkRequest nr : mNetworkRequests) {
            if (excludeDun && nr.networkCapabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_DUN)) {
                continue;
            }
            if (!nr.networkCapabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_NOT_RESTRICTED)) {
                return true;
            }
        }
    }
    return false;
}