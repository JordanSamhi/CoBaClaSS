public long nextLong() throws IOException{
    final int tokenIndex = nextTokenIndex();
    if (tokenIndex == -1) {
        throw new ProtocolException("Missing required long");
    } else {
        return parseAndConsumeLong(tokenIndex);
    }
}