public void execute(Message message){
    checkReleased();
    if (Looper.myLooper() == mLooper) {
        message.target.dispatchMessage(message);
    } else {
        MessageExecution execution = new MessageExecution();
        execution.m = message;
        synchronized (execution) {
            mExecuteQueue.add(execution);
            try {
                execution.wait();
            } catch (InterruptedException e) {
            }
            if (execution.response != null) {
                throw new RuntimeException(execution.response);
            }
        }
    }
}