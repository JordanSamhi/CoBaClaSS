public BluetoothServerSocket listenUsingL2capOn(int port, boolean mitm, boolean min16DigitPin) throws IOException{
    BluetoothServerSocket socket = new BluetoothServerSocket(BluetoothSocket.TYPE_L2CAP, true, true, port, mitm, min16DigitPin);
    int errno = socket.mSocket.bindListen();
    if (port == SOCKET_CHANNEL_AUTO_STATIC_NO_SDP) {
        int assignedChannel = socket.mSocket.getPort();
        if (DBG)
            Log.d(TAG, "listenUsingL2capOn: set assigned channel to " + assignedChannel);
        socket.setChannel(assignedChannel);
    }
    if (errno != 0) {
        throw new IOException("Error: " + errno);
    }
    return socket;
}