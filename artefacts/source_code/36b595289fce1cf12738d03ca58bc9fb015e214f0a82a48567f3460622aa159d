public static BitmapResult createLocalBitmap(final ContentResolver resolver, final Uri uri, final int maxSize){
    final BitmapResult result = new BitmapResult();
    final InputStreamFactory factory = createInputStreamFactory(resolver, uri);
    try {
        final Point bounds = getImageBounds(factory);
        if (bounds == null) {
            result.status = BitmapResult.STATUS_EXCEPTION;
            return result;
        }
        final BitmapFactory.Options opts = new BitmapFactory.Options();
        opts.inSampleSize = Math.max(bounds.x / maxSize, bounds.y / maxSize);
        result.bitmap = decodeStream(factory, null, opts);
        result.status = BitmapResult.STATUS_SUCCESS;
        return result;
    } catch (FileNotFoundException exception) {
    } catch (IOException exception) {
        result.status = BitmapResult.STATUS_EXCEPTION;
    } catch (IllegalArgumentException exception) {
    } catch (SecurityException exception) {
        result.status = BitmapResult.STATUS_EXCEPTION;
    }
    return result;
}