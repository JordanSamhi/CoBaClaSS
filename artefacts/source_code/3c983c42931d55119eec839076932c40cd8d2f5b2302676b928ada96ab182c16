public T[] toProto(Class<T> protoClass, ProtobufConverter<T> converter){
    @SuppressWarnings("unchecked")
    T[] output = (T[]) Array.newInstance(protoClass, mBuckets.size());
    int i = 0;
    for (Bucket bucket : this) {
        output[i] = converter.convert(bucket.start, bucket.end, bucket.count);
        i++;
    }
    return output;
}