public List<AppOpItem> getActiveAppOpsForUser(int userId){
    List<AppOpItem> list = new ArrayList<>();
    synchronized (mActiveItems) {
        final int numActiveItems = mActiveItems.size();
        for (int i = 0; i < numActiveItems; i++) {
            AppOpItem item = mActiveItems.get(i);
            if ((userId == UserHandle.USER_ALL || UserHandle.getUserId(item.getUid()) == userId)) {
                list.add(item);
            }
        }
    }
    synchronized (mNotedItems) {
        final int numNotedItems = mNotedItems.size();
        for (int i = 0; i < numNotedItems; i++) {
            AppOpItem item = mNotedItems.get(i);
            if ((userId == UserHandle.USER_ALL || UserHandle.getUserId(item.getUid()) == userId)) {
                list.add(item);
            }
        }
    }
    return list;
}