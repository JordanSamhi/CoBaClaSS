public static SubmitPdu getDeliverPdu(String origAddr, String message, long date){
    if (origAddr == null || message == null) {
        return null;
    }
    CdmaSmsAddress addr = CdmaSmsAddress.parse(origAddr);
    if (addr == null)
        return null;
    BearerData bearerData = new BearerData();
    bearerData.messageType = BearerData.MESSAGE_TYPE_DELIVER;
    bearerData.messageId = 0;
    bearerData.deliveryAckReq = false;
    bearerData.userAckReq = false;
    bearerData.readAckReq = false;
    bearerData.reportReq = false;
    bearerData.userData = new UserData();
    bearerData.userData.payloadStr = message;
    bearerData.msgCenterTimeStamp = BearerData.TimeStamp.fromMillis(date);
    byte[] encodedBearerData = BearerData.encode(bearerData);
    if (encodedBearerData == null)
        return null;
    try {
        ByteArrayOutputStream baos = new ByteArrayOutputStream(100);
        DataOutputStream dos = new DataOutputStream(baos);
        dos.writeInt(SmsEnvelope.TELESERVICE_WMT);
        dos.writeInt(0);
        dos.writeInt(0);
        dos.write(addr.digitMode);
        dos.write(addr.numberMode);
        dos.write(addr.ton);
        dos.write(addr.numberPlan);
        dos.write(addr.numberOfDigits);
        dos.write(addr.origBytes, 0, addr.origBytes.length);
        dos.write(0);
        dos.write(0);
        dos.write(0);
        dos.write(encodedBearerData.length);
        dos.write(encodedBearerData, 0, encodedBearerData.length);
        dos.close();
        SubmitPdu pdu = new SubmitPdu();
        pdu.encodedMessage = baos.toByteArray();
        pdu.encodedScAddress = null;
        return pdu;
    } catch (IOException ex) {
        Rlog.e(LOG_TAG, "creating Deliver PDU failed: " + ex);
    }
    return null;
}