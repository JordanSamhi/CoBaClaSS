public void addPackage(PackageSetting newPkgSetting, boolean isReplace){
    Trace.traceBegin(TRACE_TAG_PACKAGE_MANAGER, "filter.addPackage");
    try {
        if (isReplace) {
            removePackage(newPkgSetting);
        }
        mStateProvider.runWithState((settings, users) -> {
            addPackageInternal(newPkgSetting, settings);
            if (mShouldFilterCache != null) {
                updateShouldFilterCacheForPackage(null, newPkgSetting, settings, users, settings.size());
            }
        });
    } finally {
        Trace.traceEnd(TRACE_TAG_PACKAGE_MANAGER);
    }
}