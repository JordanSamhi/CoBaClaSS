public void expandStackAndSelectBubble(NotificationEntry entry){
    if (mStatusBarStateListener.getCurrentState() == SHADE) {
        mNotifEntryToExpandOnShadeUnlock = null;
        String key = entry.getKey();
        Bubble bubble = mBubbleData.getBubbleInStackWithKey(key);
        if (bubble != null) {
            mBubbleData.setSelectedBubble(bubble);
            mBubbleData.setExpanded(true);
        } else {
            bubble = mBubbleData.getOverflowBubbleWithKey(key);
            if (bubble != null) {
                promoteBubbleFromOverflow(bubble);
            } else if (entry.canBubble()) {
                setIsBubble(entry, true, true);
            }
        }
    } else {
        mNotifEntryToExpandOnShadeUnlock = entry;
    }
}