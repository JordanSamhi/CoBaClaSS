public String[] computeValidReportedPackages(@NonNull String targetPackage, int targetUid){
    if (UserHandle.getAppId(targetUid) == Process.SYSTEM_UID) {
        return EmptyArray.STRING;
    }
    String[] uidPackages = new String[] { targetPackage };
    if (mAppWidgetService != null) {
        final ArraySet<String> widgetPackages = mAppWidgetService.getHostedWidgetPackages(targetUid);
        if (widgetPackages != null && !widgetPackages.isEmpty()) {
            final String[] validPackages = new String[uidPackages.length + widgetPackages.size()];
            System.arraycopy(uidPackages, 0, validPackages, 0, uidPackages.length);
            final int widgetPackageCount = widgetPackages.size();
            for (int i = 0; i < widgetPackageCount; i++) {
                validPackages[uidPackages.length + i] = widgetPackages.valueAt(i);
            }
            return validPackages;
        }
    }
    return uidPackages;
}