public int getCarrierPrivilegeStatus(Signature signature, String packageName){
    byte[] certHash = getCertHash(signature, "SHA-1");
    byte[] certHash256 = getCertHash(signature, "SHA-256");
    if (matches(certHash, packageName) || matches(certHash256, packageName)) {
        return TelephonyManager.CARRIER_PRIVILEGE_STATUS_HAS_ACCESS;
    }
    return TelephonyManager.CARRIER_PRIVILEGE_STATUS_NO_ACCESS;
}