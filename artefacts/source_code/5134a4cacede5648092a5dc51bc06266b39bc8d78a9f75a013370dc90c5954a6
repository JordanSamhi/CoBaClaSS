public synchronized void sendNetworkCapabilities(NetworkCapabilities networkCapabilities, DataConnection dc){
    if (!isOwned(dc, "sendNetworkCapabilities"))
        return;
    if (!networkCapabilities.equals(mNetworkCapabilities)) {
        String logStr = "Changed from " + mNetworkCapabilities + " to " + networkCapabilities + ", Data RAT=" + mPhone.getServiceState().getRilDataRadioTechnology() + ", dc=" + mDataConnection.getName();
        logd(logStr);
        mNetCapsLocalLog.log(logStr);
        if (networkCapabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_INTERNET)) {
            if (mNetworkCapabilities == null || networkCapabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_TEMPORARILY_NOT_METERED) != mNetworkCapabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_TEMPORARILY_NOT_METERED)) {
                TelephonyMetrics.getInstance().writeNetworkCapabilitiesChangedEvent(mPhone.getPhoneId(), networkCapabilities);
            }
        }
        mNetworkCapabilities = networkCapabilities;
    }
    sendNetworkCapabilities(networkCapabilities);
}