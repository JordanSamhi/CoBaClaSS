public final void setTextKeepState(CharSequence text, BufferType type){
    int start = getSelectionStart();
    int end = getSelectionEnd();
    int len = text.length();
    setText(text, type);
    if (start >= 0 || end >= 0) {
        if (mSpannable != null) {
            Selection.setSelection(mSpannable, Math.max(0, Math.min(start, len)), Math.max(0, Math.min(end, len)));
        }
    }
}