public Icon getIcon(Context context){
    if (context == null || mMetaData == null) {
        return null;
    }
    ensureMetadataNotStale(context);
    final ComponentInfo componentInfo = getComponentInfo(context);
    if (componentInfo == null) {
        Log.w(TAG, "Cannot find ComponentInfo for " + getDescription());
        return null;
    }
    int iconResId = mMetaData.getInt(META_DATA_PREFERENCE_ICON);
    if (iconResId == 0) {
        if (!mMetaData.containsKey(META_DATA_PREFERENCE_ICON_URI)) {
            iconResId = getComponentIcon(componentInfo);
        }
    }
    if (iconResId != 0) {
        final Icon icon = Icon.createWithResource(componentInfo.packageName, iconResId);
        if (isIconTintable(context)) {
            final TypedArray a = context.obtainStyledAttributes(new int[] { android.R.attr.colorControlNormal });
            final int tintColor = a.getColor(0, 0);
            a.recycle();
            icon.setTint(tintColor);
        }
        return icon;
    } else {
        return null;
    }
}