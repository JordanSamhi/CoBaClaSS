public boolean getApplicationHiddenSettingAsUser(String packageName, int userId){
    mContext.enforceCallingOrSelfPermission(android.Manifest.permission.MANAGE_USERS, null);
    final int callingUid = Binder.getCallingUid();
    mPermissionManager.enforceCrossUserPermission(callingUid, userId, true, false, "getApplicationHidden for user " + userId);
    PackageSetting ps;
    long callingId = Binder.clearCallingIdentity();
    try {
        synchronized (mLock) {
            ps = mSettings.mPackages.get(packageName);
            if (ps == null) {
                return true;
            }
            if (shouldFilterApplicationLocked(ps, callingUid, userId)) {
                return true;
            }
            return ps.getHidden(userId);
        }
    } finally {
        Binder.restoreCallingIdentity(callingId);
    }
}