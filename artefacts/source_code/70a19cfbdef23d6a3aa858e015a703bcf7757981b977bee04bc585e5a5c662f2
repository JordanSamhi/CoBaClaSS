public ParcelFileDescriptor openDevice(String deviceName, String packageName){
    ParcelFileDescriptor fd = null;
    if (mHostManager != null) {
        if (deviceName != null) {
            int uid = Binder.getCallingUid();
            int pid = Binder.getCallingPid();
            int user = UserHandle.getUserId(uid);
            long ident = clearCallingIdentity();
            try {
                synchronized (mLock) {
                    if (mUserManager.isSameProfileGroup(user, mCurrentUserId)) {
                        fd = mHostManager.openDevice(deviceName, getPermissionsForUser(user), packageName, pid, uid);
                    } else {
                        Slog.w(TAG, "Cannot open " + deviceName + " for user " + user + " as user is not active.");
                    }
                }
            } finally {
                restoreCallingIdentity(ident);
            }
        }
    }
    return fd;
}