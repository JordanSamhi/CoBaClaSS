public static DisplayWhiteBalanceController create(Handler handler, SensorManager sensorManager, Resources resources){
    final AmbientSensor.AmbientBrightnessSensor brightnessSensor = createBrightnessSensor(handler, sensorManager, resources);
    final AmbientFilter brightnessFilter = AmbientFilterFactory.createBrightnessFilter(BRIGHTNESS_FILTER_TAG, resources);
    final AmbientSensor.AmbientColorTemperatureSensor colorTemperatureSensor = createColorTemperatureSensor(handler, sensorManager, resources);
    final AmbientFilter colorTemperatureFilter = AmbientFilterFactory.createColorTemperatureFilter(COLOR_TEMPERATURE_FILTER_TAG, resources);
    final DisplayWhiteBalanceThrottler throttler = createThrottler(resources);
    final float[] displayWhiteBalanceLowLightAmbientBrightnesses = getFloatArray(resources, com.android.internal.R.array.config_displayWhiteBalanceLowLightAmbientBrightnesses);
    final float[] displayWhiteBalanceLowLightAmbientBiases = getFloatArray(resources, com.android.internal.R.array.config_displayWhiteBalanceLowLightAmbientBiases);
    final float lowLightAmbientColorTemperature = getFloat(resources, com.android.internal.R.dimen.config_displayWhiteBalanceLowLightAmbientColorTemperature);
    final float[] displayWhiteBalanceHighLightAmbientBrightnesses = getFloatArray(resources, com.android.internal.R.array.config_displayWhiteBalanceHighLightAmbientBrightnesses);
    final float[] displayWhiteBalanceHighLightAmbientBiases = getFloatArray(resources, com.android.internal.R.array.config_displayWhiteBalanceHighLightAmbientBiases);
    final float highLightAmbientColorTemperature = getFloat(resources, com.android.internal.R.dimen.config_displayWhiteBalanceHighLightAmbientColorTemperature);
    final float[] ambientColorTemperatures = getFloatArray(resources, com.android.internal.R.array.config_displayWhiteBalanceAmbientColorTemperatures);
    final float[] displayColorTempeartures = getFloatArray(resources, com.android.internal.R.array.config_displayWhiteBalanceDisplayColorTemperatures);
    final DisplayWhiteBalanceController controller = new DisplayWhiteBalanceController(brightnessSensor, brightnessFilter, colorTemperatureSensor, colorTemperatureFilter, throttler, displayWhiteBalanceLowLightAmbientBrightnesses, displayWhiteBalanceLowLightAmbientBiases, lowLightAmbientColorTemperature, displayWhiteBalanceHighLightAmbientBrightnesses, displayWhiteBalanceHighLightAmbientBiases, highLightAmbientColorTemperature, ambientColorTemperatures, displayColorTempeartures);
    brightnessSensor.setCallbacks(controller);
    colorTemperatureSensor.setCallbacks(controller);
    return controller;
}