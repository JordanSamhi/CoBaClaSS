public HealthStatsParceler takeUidSnapshot(int requestUid){
    if (requestUid != Binder.getCallingUid()) {
        mContext.enforceCallingOrSelfPermission(android.Manifest.permission.BATTERY_STATS, null);
    }
    long ident = Binder.clearCallingIdentity();
    try {
        if (shouldCollectExternalStats()) {
            syncStats("get-health-stats-for-uids", BatteryExternalStatsWorker.UPDATE_ALL);
        }
        synchronized (mStats) {
            return getHealthStatsForUidLocked(requestUid);
        }
    } catch (Exception ex) {
        Slog.w(TAG, "Crashed while writing for takeUidSnapshot(" + requestUid + ")", ex);
        throw ex;
    } finally {
        Binder.restoreCallingIdentity(ident);
    }
}