public static Map<K, V> add(@Nullable Map<K, V> map, K key, V value){
    if (map == null || map == Collections.emptyMap()) {
        map = new ArrayMap<>();
    }
    map.put(key, value);
    return map;
}