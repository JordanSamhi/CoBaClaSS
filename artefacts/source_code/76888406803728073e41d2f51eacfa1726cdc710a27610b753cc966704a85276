public ParceledListSlice<StatusBarNotification> getActiveNotificationsFromListener(INotificationListener token, String[] keys, int trim){
    synchronized (mNotificationLock) {
        final ManagedServiceInfo info = mListeners.checkServiceTokenLocked(token);
        final boolean getKeys = keys != null;
        final int N = getKeys ? keys.length : mNotificationList.size();
        final ArrayList<StatusBarNotification> list = new ArrayList<StatusBarNotification>(N);
        for (int i = 0; i < N; i++) {
            final NotificationRecord r = getKeys ? mNotificationsByKey.get(keys[i]) : mNotificationList.get(i);
            if (r == null)
                continue;
            StatusBarNotification sbn = r.getSbn();
            if (!isVisibleToListener(sbn, info))
                continue;
            StatusBarNotification sbnToSend = (trim == TRIM_FULL) ? sbn : sbn.cloneLight();
            list.add(sbnToSend);
        }
        return new ParceledListSlice<StatusBarNotification>(list);
    }
}