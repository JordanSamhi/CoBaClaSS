public static X509Certificate[] getCertificateChain(@NonNull Context context, @NonNull String alias) throws KeyChainException, InterruptedException{
    if (alias == null) {
        throw new NullPointerException("alias == null");
    }
    final byte[] certificateBytes;
    final byte[] certChainBytes;
    try (KeyChainConnection keyChainConnection = bind(context.getApplicationContext())) {
        IKeyChainService keyChainService = keyChainConnection.getService();
        certificateBytes = keyChainService.getCertificate(alias);
        if (certificateBytes == null) {
            return null;
        }
        certChainBytes = keyChainService.getCaCertificates(alias);
    } catch (RemoteException e) {
        throw new KeyChainException(e);
    } catch (RuntimeException e) {
        throw new KeyChainException(e);
    }
    try {
        X509Certificate leafCert = toCertificate(certificateBytes);
        if (certChainBytes != null && certChainBytes.length != 0) {
            Collection<X509Certificate> chain = toCertificates(certChainBytes);
            ArrayList<X509Certificate> fullChain = new ArrayList<>(chain.size() + 1);
            fullChain.add(leafCert);
            fullChain.addAll(chain);
            return fullChain.toArray(new X509Certificate[fullChain.size()]);
        } else {
            TrustedCertificateStore store = new TrustedCertificateStore();
            List<X509Certificate> chain = store.getCertificateChain(leafCert);
            return chain.toArray(new X509Certificate[chain.size()]);
        }
    } catch (CertificateException | RuntimeException e) {
        throw new KeyChainException(e);
    }
}