public int getNewId() throws OutOfIdsException{
    synchronized (mLock) {
        if (mCounter == Integer.MAX_VALUE) {
            throw new OutOfIdsException();
        }
        mCounter++;
        writeState();
        return mCounter - 1;
    }
}