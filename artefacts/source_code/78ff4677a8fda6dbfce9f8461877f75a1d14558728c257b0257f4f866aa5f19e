public void setLightStates(IBinder token, int[] lightIds, LightState[] lightStates){
    getContext().enforceCallingOrSelfPermission(Manifest.permission.CONTROL_DEVICE_LIGHTS, "setLightStates requires CONTROL_DEVICE_LIGHTS permission");
    Preconditions.checkState(lightIds.length == lightStates.length);
    synchronized (LightsService.this) {
        Session session = getSessionLocked(Preconditions.checkNotNull(token));
        Preconditions.checkState(session != null, "not registered");
        checkRequestIsValid(lightIds);
        for (int i = 0; i < lightIds.length; i++) {
            session.setRequest(lightIds[i], lightStates[i]);
        }
        invalidateLightStatesLocked();
    }
}