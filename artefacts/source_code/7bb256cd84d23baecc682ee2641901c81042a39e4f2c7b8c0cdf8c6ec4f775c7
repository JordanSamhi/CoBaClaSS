public boolean provisionDiscovery(WifiP2pConfig config){
    if (config == null)
        return false;
    synchronized (mLock) {
        if (!checkSupplicantP2pIfaceAndLogFailure("provisionDiscovery"))
            return false;
        int targetMethod = wpsInfoToConfigMethod(config.wps.setup);
        if (targetMethod == RESULT_NOT_VALID) {
            Log.e(TAG, "Unrecognized WPS configuration method: " + config.wps.setup);
            return false;
        }
        if (targetMethod == ISupplicantP2pIface.WpsProvisionMethod.DISPLAY) {
            targetMethod = ISupplicantP2pIface.WpsProvisionMethod.KEYPAD;
        } else if (targetMethod == ISupplicantP2pIface.WpsProvisionMethod.KEYPAD) {
            targetMethod = ISupplicantP2pIface.WpsProvisionMethod.DISPLAY;
        }
        if (config.deviceAddress == null) {
            Log.e(TAG, "Cannot parse null mac address.");
            return false;
        }
        byte[] macAddress = null;
        try {
            macAddress = NativeUtil.macAddressToByteArray(config.deviceAddress);
        } catch (Exception e) {
            Log.e(TAG, "Could not parse peer mac address.", e);
            return false;
        }
        SupplicantResult<Void> result = new SupplicantResult("provisionDiscovery(" + config.deviceAddress + ", " + config.wps.setup + ")");
        try {
            result.setResult(mISupplicantP2pIface.provisionDiscovery(macAddress, targetMethod));
        } catch (RemoteException e) {
            Log.e(TAG, "ISupplicantP2pIface exception: " + e);
            supplicantServiceDiedHandler();
        }
        return result.isSuccess();
    }
}