public ChunkHash computeHash(byte[] plaintext) throws InvalidKeyException{
    try {
        Mac mac = Mac.getInstance(MAC_ALGORITHM);
        mac.init(mSecretKey);
        return new ChunkHash(mac.doFinal(plaintext));
    } catch (NoSuchAlgorithmException e) {
        throw new AssertionError(e);
    }
}