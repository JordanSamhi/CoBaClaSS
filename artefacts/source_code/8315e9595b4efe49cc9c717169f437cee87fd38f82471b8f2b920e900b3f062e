public static void create(final View targetView, final Consumer<SyncRtSurfaceTransactionApplier> callback){
    if (targetView == null) {
        callback.accept(null);
    } else if (targetView.getViewRootImpl() != null) {
        callback.accept(new SyncRtSurfaceTransactionApplier(targetView));
    } else {
        targetView.addOnAttachStateChangeListener(new View.OnAttachStateChangeListener() {

            @Override
            public void onViewAttachedToWindow(View v) {
                targetView.removeOnAttachStateChangeListener(this);
                callback.accept(new SyncRtSurfaceTransactionApplier(targetView));
            }

            @Override
            public void onViewDetachedFromWindow(View v) {
            }
        });
    }
}