public void testRequestBackup_whenTransportNotRegistered() throws Exception{
    mShadowContext.grantPermissions(android.Manifest.permission.BACKUP);
    setUpCurrentTransport(mTransportManager, mTransport.unregistered());
    UserBackupManagerService backupManagerService = createUserBackupManagerServiceAndRunTasks();
    backupManagerService.setEnabled(true);
    backupManagerService.setSetupComplete(true);
    int result = backupManagerService.requestBackup(new String[] { PACKAGE_1 }, mObserver, 0);
    assertThat(result).isEqualTo(BackupManager.ERROR_TRANSPORT_ABORTED);
    verify(mObserver).backupFinished(BackupManager.ERROR_TRANSPORT_ABORTED);
}