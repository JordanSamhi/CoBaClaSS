public void startConnectionEvent(int connectionType, WifiP2pConfig config){
    synchronized (mLock) {
        if (mCurrentConnectionEvent != null) {
            endConnectionEvent(P2pConnectionEvent.CLF_NEW_CONNECTION_ATTEMPT);
        }
        while (mConnectionEventList.size() >= MAX_CONNECTION_EVENTS) {
            mConnectionEventList.remove(0);
        }
        mCurrentConnectionEventStartTime = mClock.getElapsedSinceBootMillis();
        mCurrentConnectionEvent = new P2pConnectionEvent();
        mCurrentConnectionEvent.startTimeMillis = mClock.getWallClockMillis();
        mCurrentConnectionEvent.connectionType = connectionType;
        if (config != null) {
            mCurrentConnectionEvent.wpsMethod = config.wps.setup;
        }
        mConnectionEventList.add(mCurrentConnectionEvent);
    }
}