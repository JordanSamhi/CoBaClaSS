public void waitForIdle(long timeoutMillis) throws InterruptedException, TimeoutException{
    try {
        final CountDownLatch countDownLatch = new CountDownLatch(1);
        mService.waitForIdle(new RemoteCallback((result) -> countDownLatch.countDown()));
        if (!countDownLatch.await(timeoutMillis, TimeUnit.MILLISECONDS)) {
            throw new TimeoutException("Timed out waiting for service to become idle");
        }
    } catch (ParcelableException e) {
        throw new RuntimeException(e);
    } catch (RemoteException e) {
        throw e.rethrowFromSystemServer();
    }
}