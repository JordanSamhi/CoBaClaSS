public void enforceCanAccessScanResults(String pkgName, @Nullable String featureId, int uid, @Nullable String message) throws SecurityException{
    checkPackage(uid, pkgName);
    if (checkNetworkSettingsPermission(uid) || checkNetworkSetupWizardPermission(uid) || checkNetworkManagedProvisioningPermission(uid) || checkNetworkStackPermission(uid) || checkMainlineNetworkStackPermission(uid) || checkScanWithoutLocationPermission(uid)) {
        return;
    }
    if (!isLocationModeEnabled()) {
        throw new SecurityException("Location mode is disabled for the device");
    }
    boolean canCallingUidAccessLocation = checkCallerHasPeersMacAddressPermission(uid);
    boolean canAppPackageUseLocation = checkCallersLocationPermission(pkgName, featureId, uid, true, message);
    if (!canCallingUidAccessLocation && !canAppPackageUseLocation) {
        throw new SecurityException("UID " + uid + " has no location permission");
    }
    if (!isScanAllowedbyApps(pkgName, featureId, uid)) {
        throw new SecurityException("UID " + uid + " has no wifi scan permission");
    }
    if (!isCurrentProfile(uid) && !checkInteractAcrossUsersFull(uid)) {
        throw new SecurityException("UID " + uid + " profile not permitted");
    }
}