public List<ActivityManager.RunningTaskInfo> getFilteredTasks(int maxNum, boolean filterOnlyVisibleRecents){
    final int callingUid = Binder.getCallingUid();
    final int callingPid = Binder.getCallingPid();
    final boolean crossUser = isCrossUserAllowed(callingPid, callingUid);
    final int[] profileIds = getUserManager().getProfileIds(UserHandle.getUserId(callingUid), true);
    ArraySet<Integer> callingProfileIds = new ArraySet<>();
    for (int i = 0; i < profileIds.length; i++) {
        callingProfileIds.add(profileIds[i]);
    }
    ArrayList<ActivityManager.RunningTaskInfo> list = new ArrayList<>();
    synchronized (mGlobalLock) {
        if (DEBUG_ALL)
            Slog.v(TAG, "getTasks: max=" + maxNum);
        final boolean allowed = isGetTasksAllowed("getTasks", callingPid, callingUid);
        mRootWindowContainer.getRunningTasks(maxNum, list, filterOnlyVisibleRecents, callingUid, allowed, crossUser, callingProfileIds);
    }
    return list;
}