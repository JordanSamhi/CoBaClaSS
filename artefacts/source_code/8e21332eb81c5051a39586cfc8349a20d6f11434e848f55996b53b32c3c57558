public static CredentialType parse(ByteBuffer payload, int length, boolean tunneled) throws ProtocolException{
    if (length != EXPECTED_LENGTH_VALUE) {
        throw new ProtocolException("Invalid length: " + length);
    }
    int credType = payload.get() & 0xFF;
    int authType = tunneled ? AuthParam.PARAM_TYPE_TUNNELED_EAP_METHOD_CREDENTIAL_TYPE : AuthParam.PARAM_TYPE_CREDENTIAL_TYPE;
    return new CredentialType(authType, credType);
}