public boolean isNiapModeOn(Context context){
    DevicePolicyManager devicePolicyManager = context.getSystemService(DevicePolicyManager.class);
    if (devicePolicyManager == null && context.getPackageManager().hasSystemFeature(FEATURE_DEVICE_ADMIN)) {
        Log.e(TAG, "Error retrieving DPM service");
    }
    if (devicePolicyManager == null)
        return false;
    return devicePolicyManager.isCommonCriteriaModeEnabled(null);
}