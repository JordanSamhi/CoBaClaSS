public static CharSequence formatRelativeTime(Context context, double millis, boolean withSeconds, RelativeDateTimeFormatter.Style formatStyle){
    final int seconds = (int) Math.floor(millis / 1000);
    final RelativeUnit unit;
    final int value;
    if (withSeconds && seconds < 2 * SECONDS_PER_MINUTE) {
        return context.getResources().getString(R.string.time_unit_just_now);
    } else if (seconds < 2 * SECONDS_PER_HOUR) {
        unit = RelativeUnit.MINUTES;
        value = (seconds + SECONDS_PER_MINUTE / 2) / SECONDS_PER_MINUTE;
    } else if (seconds < 2 * SECONDS_PER_DAY) {
        unit = RelativeUnit.HOURS;
        value = (seconds + SECONDS_PER_HOUR / 2) / SECONDS_PER_HOUR;
    } else {
        unit = RelativeUnit.DAYS;
        value = (seconds + SECONDS_PER_DAY / 2) / SECONDS_PER_DAY;
    }
    final Locale locale = context.getResources().getConfiguration().locale;
    final RelativeDateTimeFormatter formatter = RelativeDateTimeFormatter.getInstance(ULocale.forLocale(locale), null, formatStyle, android.icu.text.DisplayContext.CAPITALIZATION_FOR_MIDDLE_OF_SENTENCE);
    return formatter.format(value, RelativeDateTimeFormatter.Direction.LAST, unit);
}