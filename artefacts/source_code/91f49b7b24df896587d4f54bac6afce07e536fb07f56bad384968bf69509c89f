public static NAIRealmData parse(ByteBuffer payload) throws ProtocolException{
    int length = (int) ByteBufferReader.readInteger(payload, ByteOrder.LITTLE_ENDIAN, 2) & 0xFFFF;
    if (length > payload.remaining()) {
        throw new ProtocolException("Invalid data length: " + length);
    }
    boolean utf8 = (payload.get() & NAI_ENCODING_UTF8_MASK) != 0;
    String realm = ByteBufferReader.readStringWithByteLength(payload, utf8 ? StandardCharsets.UTF_8 : StandardCharsets.US_ASCII);
    List<String> realmList = Arrays.asList(realm.split(NAI_REALM_STRING_SEPARATOR));
    int methodCount = payload.get() & 0xFF;
    List<EAPMethod> eapMethodList = new ArrayList<>();
    while (methodCount > 0) {
        eapMethodList.add(EAPMethod.parse(payload));
        methodCount--;
    }
    return new NAIRealmData(realmList, eapMethodList);
}