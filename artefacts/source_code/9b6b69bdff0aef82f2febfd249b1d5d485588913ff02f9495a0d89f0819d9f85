public static PageRange[] computeWhichPagesInFileToPrint(PageRange[] pagesInDocRequested, PageRange[] pagesWrittenToFile, int pageCount){
    if (Arrays.equals(pagesInDocRequested, ALL_PAGES_RANGE) && pageCount == PrintDocumentInfo.PAGE_COUNT_UNKNOWN) {
        return ALL_PAGES_RANGE;
    } else if (Arrays.equals(pagesWrittenToFile, pagesInDocRequested)) {
        return ALL_PAGES_RANGE;
    } else if (Arrays.equals(pagesWrittenToFile, ALL_PAGES_RANGE)) {
        return pagesInDocRequested;
    } else if (PageRangeUtils.contains(pagesWrittenToFile, pagesInDocRequested, pageCount)) {
        final int offset = -pagesWrittenToFile[0].getStart();
        PageRangeUtils.offset(pagesInDocRequested.clone(), offset);
        return pagesInDocRequested;
    } else if (Arrays.equals(pagesInDocRequested, ALL_PAGES_RANGE) && isAllPages(pagesWrittenToFile, pageCount)) {
        return ALL_PAGES_RANGE;
    }
    return null;
}