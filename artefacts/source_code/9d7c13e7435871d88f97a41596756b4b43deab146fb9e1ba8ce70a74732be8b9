public ParcelFileDescriptor getWallpaperFile(@SetWallpaperFlags int which, int userId){
    if (which != FLAG_SYSTEM && which != FLAG_LOCK) {
        throw new IllegalArgumentException("Must request exactly one kind of wallpaper");
    }
    if (sGlobals.mService == null) {
        Log.w(TAG, "WallpaperService not running");
        throw new RuntimeException(new DeadSystemException());
    } else {
        try {
            Bundle outParams = new Bundle();
            return sGlobals.mService.getWallpaperWithFeature(mContext.getOpPackageName(), mContext.getAttributionTag(), null, which, outParams, userId);
        } catch (RemoteException e) {
            throw e.rethrowFromSystemServer();
        } catch (SecurityException e) {
            if (mContext.getApplicationInfo().targetSdkVersion < Build.VERSION_CODES.O_MR1) {
                Log.w(TAG, "No permission to access wallpaper, suppressing" + " exception to avoid crashing legacy app.");
                return null;
            } else {
                throw e;
            }
        }
    }
}