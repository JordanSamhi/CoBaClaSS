public ActivityInfo getTargetActivityInfo(Intent intent, int currentUserId, boolean onlyDirectBootAware){
    PackageManager packageManager = mContext.getPackageManager();
    int flags = PackageManager.MATCH_DEFAULT_ONLY;
    if (!onlyDirectBootAware) {
        flags |= PackageManager.MATCH_DIRECT_BOOT_AWARE | PackageManager.MATCH_DIRECT_BOOT_UNAWARE;
    }
    final List<ResolveInfo> appList = packageManager.queryIntentActivitiesAsUser(intent, flags, currentUserId);
    if (appList.size() == 0) {
        return null;
    }
    ResolveInfo resolved = packageManager.resolveActivityAsUser(intent, flags | PackageManager.GET_META_DATA, currentUserId);
    if (resolved == null || wouldLaunchResolverActivity(resolved, appList)) {
        return null;
    } else {
        return resolved.activityInfo;
    }
}