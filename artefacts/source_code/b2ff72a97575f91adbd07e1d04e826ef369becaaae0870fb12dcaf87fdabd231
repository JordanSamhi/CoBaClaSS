public void renameCodePath(File beforeCodeFile, File afterCodeFile) throws IllegalArgumentException, IOException{
    final File beforeCodeAbsolute = beforeCodeFile.getAbsoluteFile();
    final IncrementalStorage apkStorage = openStorage(beforeCodeAbsolute.toString());
    if (apkStorage == null) {
        throw new IllegalArgumentException("Not an Incremental path: " + beforeCodeAbsolute);
    }
    final String targetStorageDir = afterCodeFile.getAbsoluteFile().getParent();
    final IncrementalStorage linkedApkStorage = createStorage(targetStorageDir, apkStorage, IncrementalManager.CREATE_MODE_CREATE | IncrementalManager.CREATE_MODE_PERMANENT_BIND);
    if (linkedApkStorage == null) {
        throw new IOException("Failed to create linked storage at dir: " + targetStorageDir);
    }
    try {
        final String afterCodePathName = afterCodeFile.getName();
        linkFiles(apkStorage, beforeCodeAbsolute, "", linkedApkStorage, afterCodePathName);
        apkStorage.unBind(beforeCodeAbsolute.toString());
    } catch (Exception e) {
        linkedApkStorage.unBind(targetStorageDir);
        throw e;
    }
}