public void changeImsServiceFeatures(Set<ImsFeatureConfiguration.FeatureSlotPair> newImsFeatures) throws RemoteException{
    sanitizeFeatureConfig(newImsFeatures);
    synchronized (mLock) {
        if (mImsFeatures.equals(newImsFeatures)) {
            return;
        }
        mLocalLog.log("Features changed (" + mImsFeatures + "->" + newImsFeatures + ")");
        Log.i(LOG_TAG, "Features changed (" + mImsFeatures + "->" + newImsFeatures + ") for " + "ImsService: " + mComponentName);
        HashSet<ImsFeatureConfiguration.FeatureSlotPair> oldImsFeatures = new HashSet<>(mImsFeatures);
        mImsFeatures = newImsFeatures;
        if (mIsBound) {
            HashSet<ImsFeatureConfiguration.FeatureSlotPair> newFeatures = new HashSet<>(mImsFeatures);
            newFeatures.removeAll(oldImsFeatures);
            for (ImsFeatureConfiguration.FeatureSlotPair i : newFeatures) {
                addImsServiceFeature(i);
            }
            HashSet<ImsFeatureConfiguration.FeatureSlotPair> oldFeatures = new HashSet<>(oldImsFeatures);
            oldFeatures.removeAll(mImsFeatures);
            for (ImsFeatureConfiguration.FeatureSlotPair i : oldFeatures) {
                removeImsServiceFeature(i);
            }
        }
    }
}