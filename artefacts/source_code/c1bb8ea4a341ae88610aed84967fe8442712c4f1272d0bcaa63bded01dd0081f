public int getDeviceForStream(int stream){
    int device = getDevicesForStream(stream);
    if ((device & (device - 1)) != 0) {
        if ((device & AudioSystem.DEVICE_OUT_SPEAKER) != 0) {
            device = AudioSystem.DEVICE_OUT_SPEAKER;
        } else if ((device & AudioSystem.DEVICE_OUT_HDMI_ARC) != 0) {
            device = AudioSystem.DEVICE_OUT_HDMI_ARC;
        } else if ((device & AudioSystem.DEVICE_OUT_SPDIF) != 0) {
            device = AudioSystem.DEVICE_OUT_SPDIF;
        } else if ((device & AudioSystem.DEVICE_OUT_AUX_LINE) != 0) {
            device = AudioSystem.DEVICE_OUT_AUX_LINE;
        } else {
            for (int deviceType : AudioSystem.DEVICE_OUT_ALL_A2DP_SET) {
                if ((deviceType & device) == deviceType) {
                    return deviceType;
                }
            }
        }
    }
    return device;
}