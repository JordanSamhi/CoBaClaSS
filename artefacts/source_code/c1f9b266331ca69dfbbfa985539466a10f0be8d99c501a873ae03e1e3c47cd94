public int setUserIdDeviceAffinity(IAudioPolicyCallback pcb, int userId, @NonNull int[] deviceTypes, @NonNull String[] deviceAddresses){
    if (DEBUG_AP) {
        Log.d(TAG, "setUserIdDeviceAffinity for " + pcb.asBinder() + " user:" + userId);
    }
    synchronized (mAudioPolicies) {
        final AudioPolicyProxy app = checkUpdateForPolicy(pcb, "Cannot change device affinity in audio policy");
        if (app == null) {
            return AudioManager.ERROR;
        }
        if (!app.hasMixRoutedToDevices(deviceTypes, deviceAddresses)) {
            return AudioManager.ERROR;
        }
        return app.setUserIdDeviceAffinities(userId, deviceTypes, deviceAddresses);
    }
}