public void updateUsingRssi(int rssi, long millis, double standardDeviation){
    if (millis <= 0)
        return;
    if (mLastMillis <= 0 || millis < mLastMillis || mFilter.mx == null) {
        double initialVariance = 9.0 * standardDeviation * standardDeviation;
        mFilter.mx = new Matrix(1, new double[] { rssi, 0.0 });
        mFilter.mP = new Matrix(2, new double[] { initialVariance, 0.0, 0.0, 0.0 });
    } else {
        double dt = (millis - mLastMillis) * 0.001;
        mFilter.mR.put(0, 0, standardDeviation * standardDeviation);
        setDeltaTimeSeconds(dt);
        mFilter.predict();
        mFilter.update(new Matrix(1, new double[] { rssi }));
    }
    mLastMillis = millis;
    mFilteredRssi = mFilter.mx.get(0, 0);
    mEstimatedRateOfRssiChange = mFilter.mx.get(1, 0);
}