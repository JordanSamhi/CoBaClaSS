public static boolean validate(WifiConfiguration config, boolean isAdd){
    if (!validateSsid(config.SSID, isAdd)) {
        return false;
    }
    if (!validateBssid(config.BSSID)) {
        return false;
    }
    if (!validateBitSets(config)) {
        return false;
    }
    if (!validateKeyMgmt(config.allowedKeyManagement)) {
        return false;
    }
    if (config.allowedKeyManagement.get(WifiConfiguration.KeyMgmt.WPA_PSK) && !validatePassword(config.preSharedKey, isAdd, false)) {
        return false;
    }
    if (config.allowedKeyManagement.get(WifiConfiguration.KeyMgmt.OWE)) {
        if (!config.requirePmf) {
            Log.e(TAG, "PMF must be enabled for OWE networks");
            return false;
        }
    }
    if (config.allowedKeyManagement.get(WifiConfiguration.KeyMgmt.SAE)) {
        if (!config.requirePmf) {
            Log.e(TAG, "PMF must be enabled for SAE networks");
            return false;
        }
        if (!validatePassword(config.preSharedKey, isAdd, true)) {
            return false;
        }
    }
    if (config.allowedKeyManagement.get(WifiConfiguration.KeyMgmt.SUITE_B_192)) {
        if (!config.requirePmf) {
            Log.e(TAG, "PMF must be enabled for Suite-B 192-bit networks");
            return false;
        }
    }
    if (config.preSharedKey != null && !config.needsPreSharedKey()) {
        Log.e(TAG, "preSharedKey set with an invalid KeyMgmt, resetting KeyMgmt to WPA_PSK");
        config.allowedKeyManagement.clear();
        config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WPA_PSK);
    }
    if (!validateIpConfiguration(config.getIpConfiguration())) {
        return false;
    }
    return true;
}