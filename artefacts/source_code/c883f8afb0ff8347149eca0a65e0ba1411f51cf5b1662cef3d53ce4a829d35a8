public synchronized void applyTransportModeTransform(ParcelFileDescriptor socket, int direction, int resourceId) throws RemoteException{
    int callingUid = Binder.getCallingUid();
    UserRecord userRecord = mUserResourceTracker.getUserRecord(callingUid);
    checkDirection(direction);
    TransformRecord info = userRecord.mTransformRecords.getResourceOrThrow(resourceId);
    if (info.pid != getCallingPid() || info.uid != callingUid) {
        throw new SecurityException("Only the owner of an IpSec Transform may apply it!");
    }
    IpSecConfig c = info.getConfig();
    Preconditions.checkArgument(c.getMode() == IpSecTransform.MODE_TRANSPORT, "Transform mode was not Transport mode; cannot be applied to a socket");
    mSrvConfig.getNetdInstance().ipSecApplyTransportModeTransform(socket, callingUid, direction, c.getSourceAddress(), c.getDestinationAddress(), info.getSpiRecord().getSpi());
}