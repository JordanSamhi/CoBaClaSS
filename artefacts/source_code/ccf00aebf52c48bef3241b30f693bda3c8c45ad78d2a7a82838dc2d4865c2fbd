public static boolean canConnectToPrivateDnsServer(@NonNull String hostname){
    final SocketFactory factory = SSLSocketFactory.getDefault();
    TrafficStats.setThreadStatsTag(TrafficStats.TAG_SYSTEM_APP);
    try (SSLSocket socket = (SSLSocket) factory.createSocket()) {
        socket.setSoTimeout(CONNECTION_TIMEOUT_MS);
        socket.connect(new InetSocketAddress(hostname, PRIVATE_DNS_PORT));
        if (!socket.isConnected()) {
            Log.w(TAG, String.format("Connection to %s failed.", hostname));
            return false;
        }
        socket.startHandshake();
        Log.w(TAG, String.format("TLS handshake to %s succeeded.", hostname));
        return true;
    } catch (IOException e) {
        Log.w(TAG, String.format("TLS handshake to %s failed.", hostname), e);
        return false;
    }
}