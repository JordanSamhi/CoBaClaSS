public void setVrThreadLocked(int tid, int pid, WindowProcessController proc){
    if (hasPersistentVrFlagSet()) {
        Slog.w(TAG, "VR thread cannot be set in persistent VR mode!");
        return;
    }
    if (proc == null) {
        Slog.w(TAG, "Persistent VR thread not set, calling process doesn't exist!");
        return;
    }
    if (tid != 0) {
        enforceThreadInProcess(tid, pid);
    }
    if (!inVrMode()) {
        Slog.w(TAG, "VR thread cannot be set when not in VR mode!");
    } else {
        setVrRenderThreadLocked(tid, proc.getCurrentSchedulingGroup(), false);
    }
    proc.mVrThreadTid = (tid > 0) ? tid : 0;
}