public void setBubblesAllowed(String pkg, int uid, int bubblePreference){
    boolean changed = false;
    synchronized (mPackagePreferences) {
        PackagePreferences p = getOrCreatePackagePreferencesLocked(pkg, uid);
        changed = p.bubblePreference != bubblePreference;
        p.bubblePreference = bubblePreference;
        p.lockedAppFields = p.lockedAppFields | LockableAppFields.USER_LOCKED_BUBBLE;
    }
    if (changed) {
        updateConfig();
    }
}