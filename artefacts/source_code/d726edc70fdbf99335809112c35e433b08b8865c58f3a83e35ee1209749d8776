public int getCredentialTypeInternal(int userId){
    if (userId == USER_FRP) {
        return getFrpCredentialType();
    }
    synchronized (mSpManager) {
        if (isSyntheticPasswordBasedCredentialLocked(userId)) {
            final long handle = getSyntheticPasswordHandleLocked(userId);
            int rawType = mSpManager.getCredentialType(handle, userId);
            if (rawType != CREDENTIAL_TYPE_PASSWORD_OR_PIN) {
                return rawType;
            }
            return pinOrPasswordQualityToCredentialType(getKeyguardStoredQuality(userId));
        }
    }
    final int savedQuality = getKeyguardStoredQuality(userId);
    if (savedQuality == DevicePolicyManager.PASSWORD_QUALITY_SOMETHING && mStorage.hasPattern(userId)) {
        return CREDENTIAL_TYPE_PATTERN;
    }
    if (savedQuality >= DevicePolicyManager.PASSWORD_QUALITY_NUMERIC && mStorage.hasPassword(userId)) {
        return pinOrPasswordQualityToCredentialType(savedQuality);
    }
    return CREDENTIAL_TYPE_NONE;
}