public int sendMessageToNanoApp(NanoAppMessage message){
    ContextHubServiceUtil.checkPermissions(mContext);
    int result;
    if (isRegistered()) {
        ContextHubMsg messageToNanoApp = ContextHubServiceUtil.createHidlContextHubMessage(mHostEndPointId, message);
        int contextHubId = mAttachedContextHubInfo.getId();
        try {
            result = mContextHubProxy.sendMessageToHub(contextHubId, messageToNanoApp);
        } catch (RemoteException e) {
            Log.e(TAG, "RemoteException in sendMessageToNanoApp (target hub ID = " + contextHubId + ")", e);
            result = Result.UNKNOWN_FAILURE;
        }
    } else {
        Log.e(TAG, "Failed to send message to nanoapp: client connection is closed");
        result = Result.UNKNOWN_FAILURE;
    }
    return ContextHubServiceUtil.toTransactionResult(result);
}