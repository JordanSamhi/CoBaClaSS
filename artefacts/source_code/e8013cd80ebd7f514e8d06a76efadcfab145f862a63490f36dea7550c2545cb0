public int getPreferredSmsSubscription(){
    int defaultSubId = SubscriptionController.getInstance().getDefaultSmsSubId();
    if (SubscriptionManager.isValidSubscriptionId(defaultSubId)) {
        return defaultSubId;
    }
    long token = Binder.clearCallingIdentity();
    try {
        int[] activeSubs = SubscriptionController.getInstance().getActiveSubIdList(true);
        if (activeSubs.length == 1) {
            return activeSubs[0];
        }
    } finally {
        Binder.restoreCallingIdentity(token);
    }
    return SubscriptionManager.INVALID_SUBSCRIPTION_ID;
}