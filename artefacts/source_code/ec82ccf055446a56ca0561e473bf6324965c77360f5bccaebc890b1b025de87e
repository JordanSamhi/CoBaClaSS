public final int dequeueOutputBuffer(@NonNull BufferInfo info, long timeoutUs){
    synchronized (mBufferLock) {
        if (mBufferMode == BUFFER_MODE_BLOCK) {
            throw new IncompatibleWithBlockModelException("dequeueOutputBuffer() " + "is not compatible with CONFIGURE_FLAG_USE_BLOCK_MODEL. " + "Please use MediaCodec.Callback objects to get output buffer slots.");
        }
    }
    int res = native_dequeueOutputBuffer(info, timeoutUs);
    synchronized (mBufferLock) {
        if (res == INFO_OUTPUT_BUFFERS_CHANGED) {
            cacheBuffers(false);
        } else if (res >= 0) {
            validateOutputByteBuffer(mCachedOutputBuffers, res, info);
            if (mHasSurface) {
                mDequeuedOutputInfos.put(res, info.dup());
            }
        }
    }
    return res;
}