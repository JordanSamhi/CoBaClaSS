public ParceledListSlice<StatusBarNotification> getAppActiveNotifications(String pkg, int incomingUserId){
    checkCallerIsSystemOrSameApp(pkg);
    int userId = ActivityManager.handleIncomingUser(Binder.getCallingPid(), Binder.getCallingUid(), incomingUserId, true, false, "getAppActiveNotifications", pkg);
    synchronized (mNotificationLock) {
        final ArrayMap<String, StatusBarNotification> map = new ArrayMap<>(mNotificationList.size() + mEnqueuedNotifications.size());
        final int N = mNotificationList.size();
        for (int i = 0; i < N; i++) {
            StatusBarNotification sbn = sanitizeSbn(pkg, userId, mNotificationList.get(i).getSbn());
            if (sbn != null) {
                map.put(sbn.getKey(), sbn);
            }
        }
        for (NotificationRecord snoozed : mSnoozeHelper.getSnoozed(userId, pkg)) {
            StatusBarNotification sbn = sanitizeSbn(pkg, userId, snoozed.getSbn());
            if (sbn != null) {
                map.put(sbn.getKey(), sbn);
            }
        }
        final int M = mEnqueuedNotifications.size();
        for (int i = 0; i < M; i++) {
            StatusBarNotification sbn = sanitizeSbn(pkg, userId, mEnqueuedNotifications.get(i).getSbn());
            if (sbn != null) {
                map.put(sbn.getKey(), sbn);
            }
        }
        final ArrayList<StatusBarNotification> list = new ArrayList<>(map.size());
        list.addAll(map.values());
        return new ParceledListSlice<StatusBarNotification>(list);
    }
}