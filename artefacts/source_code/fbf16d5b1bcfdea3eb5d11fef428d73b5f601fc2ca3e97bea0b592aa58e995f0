public static ProviderInfo generateProviderInfo(AndroidPackage pkg, ParsedProvider p, @PackageManager.ComponentInfoFlags int flags, PackageUserState state, @NonNull ApplicationInfo applicationInfo, int userId, @Nullable PackageSetting pkgSetting){
    if (p == null)
        return null;
    if (!checkUseInstalledOrHidden(pkg, pkgSetting, state, flags)) {
        return null;
    }
    if (applicationInfo == null || !pkg.getPackageName().equals(applicationInfo.packageName)) {
        Slog.wtf(TAG, "AppInfo's package name is different. Expected=" + pkg.getPackageName() + " actual=" + (applicationInfo == null ? "(null AppInfo)" : applicationInfo.packageName));
        applicationInfo = generateApplicationInfo(pkg, flags, state, userId, pkgSetting);
    }
    if (applicationInfo == null) {
        return null;
    }
    ProviderInfo info = PackageInfoWithoutStateUtils.generateProviderInfoUnchecked(p, flags, applicationInfo);
    assignSharedFieldsForComponentInfo(info, p, pkgSetting, userId);
    return info;
}