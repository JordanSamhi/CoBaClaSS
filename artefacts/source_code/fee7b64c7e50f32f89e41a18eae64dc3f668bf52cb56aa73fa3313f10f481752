public long getMaxDurationMsLocked(long elapsedRealtimeMs){
    if (mNesting > 0) {
        final long durationMs = getCurrentDurationMsLocked(elapsedRealtimeMs);
        if (durationMs > mMaxDurationMs) {
            return durationMs;
        }
    }
    return mMaxDurationMs;
}