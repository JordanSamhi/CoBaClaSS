public static Object getPhoneTypeFromStrings(Collection<String> types, String number){
    if (number == null) {
        number = "";
    }
    int type = -1;
    String label = null;
    boolean isFax = false;
    boolean hasPref = false;
    if (types != null) {
        for (final String typeStringOrg : types) {
            if (typeStringOrg == null) {
                continue;
            }
            final String typeStringUpperCase = typeStringOrg.toUpperCase();
            if (typeStringUpperCase.equals(VCardConstants.PARAM_TYPE_PREF)) {
                hasPref = true;
            } else if (typeStringUpperCase.equals(VCardConstants.PARAM_TYPE_FAX)) {
                isFax = true;
            } else {
                final String labelCandidate;
                if (typeStringUpperCase.startsWith("X-") && type < 0) {
                    labelCandidate = typeStringOrg.substring(2);
                } else {
                    labelCandidate = typeStringOrg;
                }
                if (labelCandidate.length() == 0) {
                    continue;
                }
                final Integer tmp = sKnownPhoneTypeMap_StoI.get(labelCandidate.toUpperCase());
                if (tmp != null) {
                    final int typeCandidate = tmp;
                    final int indexOfAt = number.indexOf("@");
                    if ((typeCandidate == Phone.TYPE_PAGER && 0 < indexOfAt && indexOfAt < number.length() - 1) || type < 0 || type == Phone.TYPE_CUSTOM || type == Phone.TYPE_OTHER) {
                        type = tmp;
                    }
                } else if (type < 0) {
                    type = Phone.TYPE_CUSTOM;
                    label = labelCandidate;
                }
            }
        }
    }
    if (type < 0) {
        if (hasPref) {
            type = Phone.TYPE_MAIN;
        } else {
            type = Phone.TYPE_HOME;
        }
    }
    if (isFax) {
        if (type == Phone.TYPE_HOME) {
            type = Phone.TYPE_FAX_HOME;
        } else if (type == Phone.TYPE_WORK) {
            type = Phone.TYPE_FAX_WORK;
        } else if (type == Phone.TYPE_OTHER) {
            type = Phone.TYPE_OTHER_FAX;
        }
    }
    if (type == Phone.TYPE_CUSTOM) {
        return label;
    } else {
        return type;
    }
}