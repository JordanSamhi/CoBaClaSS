public int getOtasp(){
    int provisioningState;
    if (!mPhone.getIccRecordsLoaded()) {
        if (DBG)
            log("getOtasp: otasp uninitialized due to sim not loaded");
        return TelephonyManager.OTASP_UNINITIALIZED;
    }
    if (mPhone.isPhoneTypeGsm()) {
        if (DBG)
            log("getOtasp: otasp not needed for GSM");
        return TelephonyManager.OTASP_NOT_NEEDED;
    }
    if (mIsSubscriptionFromRuim && mMin == null) {
        return TelephonyManager.OTASP_NEEDED;
    }
    if (mMin == null || (mMin.length() < 6)) {
        if (DBG)
            log("getOtasp: bad mMin='" + mMin + "'");
        provisioningState = TelephonyManager.OTASP_UNKNOWN;
    } else {
        if ((mMin.equals(UNACTIVATED_MIN_VALUE) || mMin.substring(0, 6).equals(UNACTIVATED_MIN2_VALUE)) || SystemProperties.getBoolean("test_cdma_setup", false)) {
            provisioningState = TelephonyManager.OTASP_NEEDED;
        } else {
            provisioningState = TelephonyManager.OTASP_NOT_NEEDED;
        }
    }
    if (DBG)
        log("getOtasp: state=" + provisioningState);
    return provisioningState;
}