public void performDump(TraceMarkParser parser, BiConsumer<String, List<TraceMarkSlice>> handler){
    parser.reset();
    try {
        if (VERBOSE) {
            Log.i(TAG, "Collecting atrace dump...");
        }
        writeDataToBuf(mAutomation.executeShellCommand(ATRACE_DUMP), parser);
    } catch (IOException e) {
        Log.e(TAG, "Error in reading dump", e);
    }
    parser.forAllSlices(handler);
}