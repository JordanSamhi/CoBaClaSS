public static void setAccessibilityServiceState(Context context, ComponentName componentName, boolean enabled, int userId){
    Set<ComponentName> enabledServices = getEnabledServicesFromSettings(context, userId);
    if (enabledServices.isEmpty()) {
        enabledServices = new ArraySet<>(1);
    }
    if (enabled) {
        enabledServices.add(componentName);
    } else {
        enabledServices.remove(componentName);
    }
    final StringBuilder enabledServicesBuilder = new StringBuilder();
    for (ComponentName enabledService : enabledServices) {
        enabledServicesBuilder.append(enabledService.flattenToString());
        enabledServicesBuilder.append(SERVICES_SEPARATOR);
    }
    final int enabledServicesBuilderLength = enabledServicesBuilder.length();
    if (enabledServicesBuilderLength > 0) {
        enabledServicesBuilder.deleteCharAt(enabledServicesBuilderLength - 1);
    }
    Settings.Secure.putStringForUser(context.getContentResolver(), Settings.Secure.ENABLED_ACCESSIBILITY_SERVICES, enabledServicesBuilder.toString(), userId);
}