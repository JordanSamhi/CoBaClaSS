public IpSecTransform buildTunnelModeTransform(@NonNull InetAddress sourceAddress, @NonNull IpSecManager.SecurityParameterIndex spi) throws IpSecManager.ResourceUnavailableException, IpSecManager.SpiUnavailableException, IOException{
    Preconditions.checkNotNull(sourceAddress);
    Preconditions.checkNotNull(spi);
    if (spi.getResourceId() == INVALID_RESOURCE_ID) {
        throw new IllegalArgumentException("Invalid SecurityParameterIndex");
    }
    mConfig.setMode(MODE_TUNNEL);
    mConfig.setSourceAddress(sourceAddress.getHostAddress());
    mConfig.setSpiResourceId(spi.getResourceId());
    return new IpSecTransform(mContext, mConfig).activate();
}