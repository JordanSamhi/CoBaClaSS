public void setFormat(int formatElementIndex, Format newFormat){
    if (formatElementIndex > maxOffset) {
        throw new ArrayIndexOutOfBoundsException("maxOffset=" + maxOffset + "; formatElementIndex=" + formatElementIndex);
    }
    formats[formatElementIndex] = newFormat;
}