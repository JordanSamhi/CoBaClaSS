public void onOrientationChanged(int orientation){
    mOrientation = orientation;
    WindowManager wm = (WindowManager) getContext().getSystemService(Context.WINDOW_SERVICE);
    wm.getDefaultDisplay().getRealSize(mDisplaySize);
    Resources res = getContext().getResources();
    mStatusBarHeight = res.getDimensionPixelSize(com.android.internal.R.dimen.status_bar_height);
    mBubblePaddingTop = res.getDimensionPixelSize(R.dimen.bubble_padding_top);
    final RectF allowablePos = mStackAnimationController.getAllowableStackPositionRegion();
    mWasOnLeftBeforeRotation = mStackAnimationController.isStackOnLeftSide();
    mVerticalPosPercentBeforeRotation = (mStackAnimationController.getStackPosition().y - allowablePos.top) / (allowablePos.bottom - allowablePos.top);
    mVerticalPosPercentBeforeRotation = Math.max(0f, Math.min(1f, mVerticalPosPercentBeforeRotation));
    addOnLayoutChangeListener(mOrientationChangedListener);
    hideFlyoutImmediate();
    mManageMenu.setVisibility(View.INVISIBLE);
    mShowingManage = false;
}