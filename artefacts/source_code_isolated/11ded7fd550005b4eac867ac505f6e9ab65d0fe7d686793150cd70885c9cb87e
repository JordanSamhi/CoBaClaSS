public int getDataState(){
    try {
        ITelephony telephony = getITelephony();
        if (telephony == null)
            return DATA_DISCONNECTED;
        int state = telephony.getDataStateForSubId(getSubId(SubscriptionManager.getActiveDataSubscriptionId()));
        if (state == TelephonyManager.DATA_DISCONNECTING && !Compatibility.isChangeEnabled(GET_DATA_STATE_R_VERSION)) {
            return TelephonyManager.DATA_CONNECTED;
        }
        return state;
    } catch (RemoteException ex) {
        return DATA_DISCONNECTED;
    } catch (NullPointerException ex) {
        return DATA_DISCONNECTED;
    }
}