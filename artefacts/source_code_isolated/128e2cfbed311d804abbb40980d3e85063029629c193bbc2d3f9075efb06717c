public int getConnectedState(){
    if (mNetworkInfo == null) {
        return CONNECTED_STATE_DISCONNECTED;
    }
    switch(mNetworkInfo.getDetailedState()) {
        case SCANNING:
        case CONNECTING:
        case AUTHENTICATING:
        case OBTAINING_IPADDR:
        case VERIFYING_POOR_LINK:
        case CAPTIVE_PORTAL_CHECK:
            return CONNECTED_STATE_CONNECTING;
        case CONNECTED:
            return CONNECTED_STATE_CONNECTED;
        default:
            return CONNECTED_STATE_DISCONNECTED;
    }
}