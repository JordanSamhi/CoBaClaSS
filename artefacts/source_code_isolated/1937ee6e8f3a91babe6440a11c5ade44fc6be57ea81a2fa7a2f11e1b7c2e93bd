public OutputStream getOutputStream() throws IOException{
    if (isClosed())
        throw new SocketException("Socket is closed");
    if (!isConnected())
        throw new SocketException("Socket is not connected");
    if (isOutputShutdown())
        throw new SocketException("Socket output is shutdown");
    final Socket s = this;
    OutputStream os = null;
    try {
        os = AccessController.doPrivileged(new PrivilegedExceptionAction<OutputStream>() {

            public OutputStream run() throws IOException {
                return impl.getOutputStream();
            }
        });
    } catch (java.security.PrivilegedActionException e) {
        throw (IOException) e.getException();
    }
    return os;
}