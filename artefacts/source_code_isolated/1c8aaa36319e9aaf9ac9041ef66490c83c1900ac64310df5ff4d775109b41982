public static boolean isMainlineModule(PackageManager pm, String packageName){
    try {
        pm.getModuleInfo(packageName, 0);
        return true;
    } catch (PackageManager.NameNotFoundException e) {
    }
    try {
        final PackageInfo pkg = pm.getPackageInfo(packageName, 0);
        return pkg.applicationInfo.sourceDir.startsWith(Environment.getApexDirectory().getAbsolutePath());
    } catch (PackageManager.NameNotFoundException e) {
        return false;
    }
}