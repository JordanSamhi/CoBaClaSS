public int findScanRssi(int netId, int scanRssiValidTimeMs){
    int scanMaxRssi = WifiInfo.INVALID_RSSI;
    ScanDetailCache scanDetailCache = getScanDetailCacheForNetwork(netId);
    if (scanDetailCache == null || scanDetailCache.size() == 0)
        return scanMaxRssi;
    long nowInMillis = mClock.getWallClockMillis();
    for (ScanDetail scanDetail : scanDetailCache.values()) {
        ScanResult result = scanDetail.getScanResult();
        if (result == null)
            continue;
        boolean valid = (nowInMillis - result.seen) < scanRssiValidTimeMs;
        if (valid) {
            scanMaxRssi = Math.max(scanMaxRssi, result.level);
        }
    }
    return scanMaxRssi;
}