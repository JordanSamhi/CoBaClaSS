public Map<WifiNetworkSuggestion, List<ScanResult>> getMatchingScanResults(@NonNull List<WifiNetworkSuggestion> networkSuggestions, @Nullable List<ScanResult> scanResults, String callingPackage, String callingFeatureId){
    enforceAccessPermission();
    int uid = Binder.getCallingUid();
    long ident = Binder.clearCallingIdentity();
    try {
        mWifiPermissionsUtil.enforceCanAccessScanResults(callingPackage, callingFeatureId, uid, null);
        return mWifiThreadRunner.call(() -> {
            if (!ScanResultUtil.validateScanResultList(scanResults)) {
                return mWifiNetworkSuggestionsManager.getMatchingScanResults(networkSuggestions, mScanRequestProxy.getScanResults());
            } else {
                return mWifiNetworkSuggestionsManager.getMatchingScanResults(networkSuggestions, scanResults);
            }
        }, Collections.emptyMap());
    } catch (SecurityException e) {
        Log.e(TAG, "Permission violation - getMatchingScanResults not allowed for uid=" + uid + ", packageName=" + callingPackage + ", reason + e");
    } finally {
        Binder.restoreCallingIdentity(ident);
    }
    return Collections.emptyMap();
}