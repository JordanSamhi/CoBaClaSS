public boolean isOemUnlockAllowed(){
    enforceOemUnlockReadPermission();
    final long token = Binder.clearCallingIdentity();
    try {
        boolean allowed = mOemLock.isOemUnlockAllowedByCarrier() && mOemLock.isOemUnlockAllowedByDevice();
        setPersistentDataBlockOemUnlockAllowedBit(allowed);
        return allowed;
    } finally {
        Binder.restoreCallingIdentity(token);
    }
}