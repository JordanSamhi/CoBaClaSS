public synchronized void setLength(int length){
    if ((length + offset) > buf.length || length < 0 || (length + offset) < 0) {
        throw new IllegalArgumentException("illegal length");
    }
    this.length = length;
    this.bufLength = this.length;
}