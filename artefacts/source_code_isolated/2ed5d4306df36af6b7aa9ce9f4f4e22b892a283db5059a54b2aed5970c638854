public final void init(int opmode, Key key, AlgorithmParameterSpec params, SecureRandom random) throws InvalidKeyException, InvalidAlgorithmParameterException{
    initialized = false;
    checkOpmode(opmode);
    chooseProvider(InitType.ALGORITHM_PARAM_SPEC, opmode, key, params, null, random);
    initialized = true;
    this.opmode = opmode;
}