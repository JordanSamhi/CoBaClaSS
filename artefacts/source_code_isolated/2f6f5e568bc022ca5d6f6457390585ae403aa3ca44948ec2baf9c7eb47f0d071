public static float getMedianBorderLuma(GraphicBuffer graphicBuffer, ColorSpace colorSpace){
    if (graphicBuffer == null || graphicBuffer.getFormat() != RGBA_8888) {
        return 0;
    }
    ImageReader ir = ImageReader.newInstance(graphicBuffer.getWidth(), graphicBuffer.getHeight(), graphicBuffer.getFormat(), 1);
    ir.getSurface().attachAndQueueBufferWithColorSpace(graphicBuffer, colorSpace);
    Image image = ir.acquireLatestImage();
    if (image == null || image.getPlanes().length == 0) {
        return 0;
    }
    Image.Plane plane = image.getPlanes()[0];
    ByteBuffer buffer = plane.getBuffer();
    int width = image.getWidth();
    int height = image.getHeight();
    int pixelStride = plane.getPixelStride();
    int rowStride = plane.getRowStride();
    float[] borderLumas = new float[2 * width + 2 * height];
    int l = 0;
    for (int x = 0; x < width; x++) {
        borderLumas[l++] = getPixelLuminance(buffer, x, 0, pixelStride, rowStride);
        borderLumas[l++] = getPixelLuminance(buffer, x, height - 1, pixelStride, rowStride);
    }
    for (int y = 0; y < height; y++) {
        borderLumas[l++] = getPixelLuminance(buffer, 0, y, pixelStride, rowStride);
        borderLumas[l++] = getPixelLuminance(buffer, width - 1, y, pixelStride, rowStride);
    }
    ir.close();
    Arrays.sort(borderLumas);
    return borderLumas[borderLumas.length / 2];
}