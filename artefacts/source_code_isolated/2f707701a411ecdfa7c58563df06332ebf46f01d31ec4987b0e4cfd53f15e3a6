public static SoftApConfiguration fromWifiConfiguration(@NonNull WifiConfiguration wifiConfig){
    SoftApConfiguration.Builder configBuilder = new SoftApConfiguration.Builder();
    try {
        configBuilder.setSsid(wifiConfig.SSID);
        if (wifiConfig.getAuthType() == WifiConfiguration.KeyMgmt.WPA2_PSK) {
            configBuilder.setPassphrase(wifiConfig.preSharedKey, SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
        }
        configBuilder.setHiddenSsid(wifiConfig.hiddenSSID);
        int band;
        switch(wifiConfig.apBand) {
            case WifiConfiguration.AP_BAND_2GHZ:
                band = SoftApConfiguration.BAND_2GHZ;
                break;
            case WifiConfiguration.AP_BAND_5GHZ:
                band = SoftApConfiguration.BAND_5GHZ;
                break;
            default:
                band = SoftApConfiguration.BAND_2GHZ | SoftApConfiguration.BAND_5GHZ;
                break;
        }
        if (wifiConfig.apChannel == 0) {
            configBuilder.setBand(band);
        } else {
            configBuilder.setChannel(wifiConfig.apChannel, band);
        }
    } catch (IllegalArgumentException iae) {
        Log.e(TAG, "Invalid WifiConfiguration" + iae);
        return null;
    } catch (IllegalStateException ise) {
        Log.e(TAG, "Invalid WifiConfiguration" + ise);
        return null;
    }
    return configBuilder.build();
}