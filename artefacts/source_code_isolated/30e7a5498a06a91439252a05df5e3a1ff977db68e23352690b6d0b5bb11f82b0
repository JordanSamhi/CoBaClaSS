public void init(SSLContext tlsContext, TrustManagerFactory trustManagerFactory){
    if (tlsContext == null || trustManagerFactory == null) {
        Log.e(TAG, "Invalid arguments passed to init");
        return;
    }
    try {
        X509TrustManager x509TrustManager = null;
        for (TrustManager tm : trustManagerFactory.getTrustManagers()) {
            if (tm instanceof X509TrustManager) {
                x509TrustManager = (X509TrustManager) tm;
                break;
            }
        }
        if (x509TrustManager == null) {
            Log.e(TAG, "Unable to initialize trust manager");
            return;
        }
        mTrustManager = new WFATrustManager(x509TrustManager);
        tlsContext.init(null, new TrustManager[] { mTrustManager }, null);
        mSocketFactory = tlsContext.getSocketFactory();
    } catch (KeyManagementException e) {
        Log.w(TAG, "Initialization failed");
        e.printStackTrace();
        return;
    }
    mSetupComplete = true;
    if (mLooper == null) {
        mOsuServerHandlerThread = new HandlerThread("OsuServerHandler");
        mOsuServerHandlerThread.start();
        mLooper = mOsuServerHandlerThread.getLooper();
    }
    mHandler = new Handler(mLooper);
}