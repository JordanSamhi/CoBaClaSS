public void noteUsageStart(String name, int userId, long timeAgoMs) throws IllegalArgumentException{
    synchronized (mLock) {
        UserData user = getOrCreateUserDataLocked(userId);
        if (DEBUG)
            Slog.d(TAG, "Usage entity " + name + " became active");
        final int index = user.currentlyActive.indexOfKey(name);
        if (index >= 0) {
            final Integer count = user.currentlyActive.valueAt(index);
            if (count != null) {
                user.currentlyActive.setValueAt(index, count + 1);
                return;
            }
        }
        final long currentTime = getUptimeMillis();
        user.currentlyActive.put(name, ONE);
        ArrayList<UsageGroup> groups = user.observedMap.get(name);
        if (groups == null)
            return;
        final int size = groups.size();
        for (int i = 0; i < size; i++) {
            UsageGroup group = groups.get(i);
            group.noteUsageStart(currentTime - timeAgoMs, currentTime);
        }
    }
}