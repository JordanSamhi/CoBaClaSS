public void fixSeInfoLocked(){
    if (packages == null || packages.size() == 0) {
        return;
    }
    for (PackageSetting ps : packages) {
        if ((ps == null) || (ps.pkg == null)) {
            continue;
        }
        if (ps.pkg.getTargetSdkVersion() < seInfoTargetSdkVersion) {
            seInfoTargetSdkVersion = ps.pkg.getTargetSdkVersion();
        }
    }
    for (PackageSetting ps : packages) {
        if ((ps == null) || (ps.pkg == null)) {
            continue;
        }
        final boolean isPrivileged = isPrivileged() | ps.pkg.isPrivileged();
        ps.getPkgState().setOverrideSeInfo(SELinuxMMAC.getSeInfo(ps.pkg, isPrivileged, seInfoTargetSdkVersion));
    }
}