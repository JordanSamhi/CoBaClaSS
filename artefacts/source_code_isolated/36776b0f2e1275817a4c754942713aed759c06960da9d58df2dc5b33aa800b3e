public synchronized void updateWifiLockWorkSource(IBinder binder, WorkSource ws){
    WifiLock wl = findLockByBinder(binder);
    if (wl == null) {
        throw new IllegalArgumentException("Wifi lock not active");
    }
    WorkSource newWorkSource = new WorkSource(ws);
    if (mVerboseLoggingEnabled) {
        Log.d(TAG, "updateWifiLockWakeSource: " + wl + ", newWorkSource=" + newWorkSource);
    }
    switch(wl.mMode) {
        case WifiManager.WIFI_MODE_FULL_HIGH_PERF:
            if (canActivateHighPerfLock()) {
                setBlameHiPerfWs(newWorkSource, true);
                setBlameHiPerfWs(wl.mWorkSource, false);
            }
            break;
        case WifiManager.WIFI_MODE_FULL_LOW_LATENCY:
            addWsToLlWatchList(newWorkSource);
            removeWsFromLlWatchList(wl.mWorkSource);
            updateOpMode();
            break;
        default:
            break;
    }
    wl.mWorkSource = newWorkSource;
}