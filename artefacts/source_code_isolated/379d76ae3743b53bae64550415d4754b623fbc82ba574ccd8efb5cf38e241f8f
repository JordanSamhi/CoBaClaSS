public int getCarrierPrivilegeStatus(PackageManager packageManager, String packageName){
    try {
        if (!hasCarrierPrivilegeRules()) {
            int state = mState.get();
            if (state == STATE_LOADING) {
                return TelephonyManager.CARRIER_PRIVILEGE_STATUS_RULES_NOT_LOADED;
            } else if (state == STATE_ERROR) {
                return TelephonyManager.CARRIER_PRIVILEGE_STATUS_ERROR_LOADING_RULES;
            }
            return TelephonyManager.CARRIER_PRIVILEGE_STATUS_NO_ACCESS;
        }
        PackageInfo pInfo = packageManager.getPackageInfo(packageName, PackageManager.GET_SIGNING_CERTIFICATES | PackageManager.MATCH_DISABLED_UNTIL_USED_COMPONENTS | PackageManager.MATCH_HIDDEN_UNTIL_INSTALLED_COMPONENTS);
        return getCarrierPrivilegeStatus(pInfo);
    } catch (PackageManager.NameNotFoundException ex) {
        log("Package " + packageName + " not found for carrier privilege status check");
    }
    return TelephonyManager.CARRIER_PRIVILEGE_STATUS_NO_ACCESS;
}