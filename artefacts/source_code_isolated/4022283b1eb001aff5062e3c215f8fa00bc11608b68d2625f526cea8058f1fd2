public KeyChainSnapshot getKeyChainSnapshot() throws RemoteException{
    checkRecoverKeyStorePermission();
    int uid = Binder.getCallingUid();
    KeyChainSnapshot snapshot = mSnapshotStorage.get(uid);
    if (snapshot == null) {
        throw new ServiceSpecificException(ERROR_NO_SNAPSHOT_PENDING);
    }
    return snapshot;
}