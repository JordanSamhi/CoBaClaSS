public Map<String, Map<Integer, List<ScanResult>>> getAllMatchingPasspointProfilesForScanResults(List<ScanResult> scanResults){
    if (scanResults == null) {
        Log.e(TAG, "Attempt to get matching config for a null ScanResults");
        return new HashMap<>();
    }
    Map<String, Map<Integer, List<ScanResult>>> configs = new HashMap<>();
    for (ScanResult scanResult : scanResults) {
        if (!scanResult.isPasspointNetwork())
            continue;
        List<Pair<PasspointProvider, PasspointMatch>> matchedProviders = getAllMatchedProviders(scanResult);
        for (Pair<PasspointProvider, PasspointMatch> matchedProvider : matchedProviders) {
            WifiConfiguration config = matchedProvider.first.getWifiConfig();
            int type = WifiManager.PASSPOINT_HOME_NETWORK;
            if (!config.isHomeProviderNetwork) {
                type = WifiManager.PASSPOINT_ROAMING_NETWORK;
            }
            Map<Integer, List<ScanResult>> scanResultsPerNetworkType = configs.get(config.getKey());
            if (scanResultsPerNetworkType == null) {
                scanResultsPerNetworkType = new HashMap<>();
                configs.put(config.getKey(), scanResultsPerNetworkType);
            }
            List<ScanResult> matchingScanResults = scanResultsPerNetworkType.get(type);
            if (matchingScanResults == null) {
                matchingScanResults = new ArrayList<>();
                scanResultsPerNetworkType.put(type, matchingScanResults);
            }
            matchingScanResults.add(scanResult);
        }
    }
    return configs;
}