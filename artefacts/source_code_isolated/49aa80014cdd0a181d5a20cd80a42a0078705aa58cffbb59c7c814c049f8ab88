public static X509Certificate[] attestDeviceIds(Context context, @NonNull int[] idTypes, @NonNull byte[] attestationChallenge) throws DeviceIdAttestationException{
    final KeymasterArguments attestArgs = prepareAttestationArgumentsForDeviceId(context, idTypes, attestationChallenge);
    final KeymasterCertificateChain outChain = new KeymasterCertificateChain();
    final int errorCode = KeyStore.getInstance().attestDeviceIds(attestArgs, outChain);
    if (errorCode != KeyStore.NO_ERROR) {
        throw new DeviceIdAttestationException("Unable to perform attestation", KeyStore.getKeyStoreException(errorCode));
    }
    try {
        return parseCertificateChain(outChain);
    } catch (KeyAttestationException e) {
        throw new DeviceIdAttestationException(e.getMessage(), e);
    }
}