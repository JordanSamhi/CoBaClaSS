public void setTempFileRootDirectory(@NonNull File tempFileRootDirectory){
    IMbmsDownloadService downloadService = mService.get();
    if (downloadService == null) {
        throw new IllegalStateException("Middleware not yet bound");
    }
    try {
        validateTempFileRootSanity(tempFileRootDirectory);
    } catch (IOException e) {
        throw new IllegalStateException("Got IOException checking directory sanity");
    }
    String filePath;
    try {
        filePath = tempFileRootDirectory.getCanonicalPath();
    } catch (IOException e) {
        throw new IllegalArgumentException("Unable to canonicalize the provided path: " + e);
    }
    try {
        int result = downloadService.setTempFileRootDirectory(mSubscriptionId, filePath);
        if (result == MbmsErrors.UNKNOWN) {
            close();
            throw new IllegalStateException("Middleware must not return an unknown error code");
        }
        if (result != MbmsErrors.SUCCESS) {
            sendErrorToApp(result, null);
            return;
        }
    } catch (RemoteException e) {
        mService.set(null);
        sIsInitialized.set(false);
        sendErrorToApp(MbmsErrors.ERROR_MIDDLEWARE_LOST, null);
        return;
    }
    SharedPreferences prefs = mContext.getSharedPreferences(MbmsTempFileProvider.TEMP_FILE_ROOT_PREF_FILE_NAME, 0);
    prefs.edit().putString(MbmsTempFileProvider.TEMP_FILE_ROOT_PREF_NAME, filePath).apply();
}