public void updateMediaMetaData(boolean metaDataChanged, boolean allowEnterAnimation){
    Trace.beginSection("StatusBar#updateMediaMetaData");
    if (!SHOW_LOCKSCREEN_MEDIA_ARTWORK) {
        Trace.endSection();
        return;
    }
    if (mBackdrop == null) {
        Trace.endSection();
        return;
    }
    boolean wakeAndUnlock = mBiometricUnlockController != null && mBiometricUnlockController.isWakeAndUnlock();
    if (mKeyguardStateController.isLaunchTransitionFadingAway() || wakeAndUnlock) {
        mBackdrop.setVisibility(View.INVISIBLE);
        Trace.endSection();
        return;
    }
    MediaMetadata mediaMetadata = getMediaMetadata();
    if (DEBUG_MEDIA) {
        Log.v(TAG, "DEBUG_MEDIA: updating album art for notification " + getMediaNotificationKey() + " metadata=" + mediaMetadata + " metaDataChanged=" + metaDataChanged + " state=" + mStatusBarStateController.getState());
    }
    Bitmap artworkBitmap = null;
    if (mediaMetadata != null && !mKeyguardBypassController.getBypassEnabled()) {
        artworkBitmap = mediaMetadata.getBitmap(MediaMetadata.METADATA_KEY_ART);
        if (artworkBitmap == null) {
            artworkBitmap = mediaMetadata.getBitmap(MediaMetadata.METADATA_KEY_ALBUM_ART);
        }
    }
    if (metaDataChanged) {
        for (AsyncTask<?, ?, ?> task : mProcessArtworkTasks) {
            task.cancel(true);
        }
        mProcessArtworkTasks.clear();
    }
    if (artworkBitmap != null && !Utils.useQsMediaPlayer(mContext)) {
        mProcessArtworkTasks.add(new ProcessArtworkTask(this, metaDataChanged, allowEnterAnimation).execute(artworkBitmap));
    } else {
        finishUpdateMediaMetaData(metaDataChanged, allowEnterAnimation, null);
    }
    Trace.endSection();
}