public static SigningDetails getSigningDetails(ParsingPackageRead pkg, boolean skipVerify) throws PackageParserException{
    SigningDetails signingDetails = SigningDetails.UNKNOWN;
    ParseInput input = ParseTypeImpl.forDefaultParsing().reset();
    Trace.traceBegin(TRACE_TAG_PACKAGE_MANAGER, "collectCertificates");
    try {
        ParseResult<SigningDetails> result = getSigningDetails(input, pkg.getBaseCodePath(), skipVerify, pkg.isStaticSharedLibrary(), signingDetails, pkg.getTargetSdkVersion());
        if (result.isError()) {
            throw new PackageParser.PackageParserException(result.getErrorCode(), result.getErrorMessage(), result.getException());
        }
        signingDetails = result.getResult();
        String[] splitCodePaths = pkg.getSplitCodePaths();
        if (!ArrayUtils.isEmpty(splitCodePaths)) {
            for (int i = 0; i < splitCodePaths.length; i++) {
                result = getSigningDetails(input, splitCodePaths[i], skipVerify, pkg.isStaticSharedLibrary(), signingDetails, pkg.getTargetSdkVersion());
                if (result.isError()) {
                    throw new PackageParser.PackageParserException(result.getErrorCode(), result.getErrorMessage(), result.getException());
                }
                signingDetails = result.getResult();
            }
        }
        return signingDetails;
    } finally {
        Trace.traceEnd(TRACE_TAG_PACKAGE_MANAGER);
    }
}