public T[] toProto(Class<T> protoClass, ProtobufConverter<K, T> converter){
    @SuppressWarnings("unchecked")
    T[] output = (T[]) Array.newInstance(protoClass, size());
    int i = 0;
    for (Map.Entry<K, Integer> entry : this) {
        output[i] = converter.convert(entry.getKey(), entry.getValue());
        i++;
    }
    return output;
}