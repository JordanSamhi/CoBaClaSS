public final void update(byte[] input) throws IllegalStateException{
    chooseFirstProvider();
    if (initialized == false) {
        throw new IllegalStateException("MAC not initialized");
    }
    if (input != null) {
        spi.engineUpdate(input, 0, input.length);
    }
}