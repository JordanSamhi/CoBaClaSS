public static void setAllowedKeyManagementFromScanResult(ScanResult scanResult, WifiConfiguration config){
    if (isScanResultForSaeNetwork(scanResult)) {
        config.setSecurityParams(WifiConfiguration.SECURITY_TYPE_SAE);
    } else if (isScanResultForWapiPskNetwork(scanResult)) {
        config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WAPI_PSK);
    } else if (isScanResultForWapiCertNetwork(scanResult)) {
        config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WAPI_CERT);
    } else if (isScanResultForPskNetwork(scanResult)) {
        config.setSecurityParams(WifiConfiguration.SECURITY_TYPE_PSK);
    } else if (isScanResultForEapSuiteBNetwork(scanResult)) {
        config.setSecurityParams(WifiConfiguration.SECURITY_TYPE_EAP_SUITE_B);
    } else if (isScanResultForEapNetwork(scanResult)) {
        config.setSecurityParams(WifiConfiguration.SECURITY_TYPE_EAP);
    } else if (isScanResultForWepNetwork(scanResult)) {
        config.setSecurityParams(WifiConfiguration.SECURITY_TYPE_WEP);
    } else if (isScanResultForOweNetwork(scanResult)) {
        config.setSecurityParams(WifiConfiguration.SECURITY_TYPE_OWE);
    } else {
        config.setSecurityParams(WifiConfiguration.SECURITY_TYPE_OPEN);
    }
}