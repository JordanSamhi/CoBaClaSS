public void setCaCertificates(@Nullable X509Certificate[] certs){
    if (certs != null) {
        X509Certificate[] newCerts = new X509Certificate[certs.length];
        for (int i = 0; i < certs.length; i++) {
            if (certs[i].getBasicConstraints() >= 0) {
                newCerts[i] = certs[i];
            } else {
                mCaCerts = null;
                throw new IllegalArgumentException("Not a CA certificate");
            }
        }
        mCaCerts = newCerts;
        mIsAppInstalledCaCert = true;
    } else {
        mCaCerts = null;
    }
}