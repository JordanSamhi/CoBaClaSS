public static EAPMethod parse(ByteBuffer payload) throws ProtocolException{
    int length = payload.get() & 0xFF;
    if (length > payload.remaining()) {
        throw new ProtocolException("Invalid data length: " + length);
    }
    int methodID = payload.get() & 0xFF;
    int authCount = payload.get() & 0xFF;
    Map<Integer, Set<AuthParam>> authParams = new HashMap<>();
    while (authCount > 0) {
        addAuthParam(authParams, parseAuthParam(payload));
        authCount--;
    }
    return new EAPMethod(methodID, authParams);
}