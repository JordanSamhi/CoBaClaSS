public void update(String className, long timeStamp, int eventType, int instanceId){
    switch(eventType) {
        case ACTIVITY_RESUMED:
        case ACTIVITY_PAUSED:
        case ACTIVITY_STOPPED:
        case ACTIVITY_DESTROYED:
            updateActivity(className, timeStamp, eventType, instanceId);
            break;
        case END_OF_DAY:
            if (hasForegroundActivity()) {
                incrementTimeUsed(timeStamp);
            }
            if (hasVisibleActivity()) {
                incrementTimeVisible(timeStamp);
            }
            break;
        case FOREGROUND_SERVICE_START:
        case FOREGROUND_SERVICE_STOP:
            updateForegroundService(className, timeStamp, eventType);
            break;
        case ROLLOVER_FOREGROUND_SERVICE:
            if (anyForegroundServiceStarted()) {
                incrementServiceTimeUsed(timeStamp);
            }
            break;
        case CONTINUING_FOREGROUND_SERVICE:
            mLastTimeForegroundServiceUsed = timeStamp;
            mForegroundServices.put(className, eventType);
            break;
        case DEVICE_SHUTDOWN:
        case FLUSH_TO_DISK:
            if (hasForegroundActivity()) {
                incrementTimeUsed(timeStamp);
            }
            if (hasVisibleActivity()) {
                incrementTimeVisible(timeStamp);
            }
            if (anyForegroundServiceStarted()) {
                incrementServiceTimeUsed(timeStamp);
            }
            break;
        case USER_INTERACTION:
            if (hasForegroundActivity()) {
                incrementTimeUsed(timeStamp);
            } else {
                mLastTimeUsed = timeStamp;
            }
            if (hasVisibleActivity()) {
                incrementTimeVisible(timeStamp);
            } else {
                mLastTimeVisible = timeStamp;
            }
            break;
        default:
            break;
    }
    mEndTimeStamp = timeStamp;
    if (eventType == ACTIVITY_RESUMED) {
        mLaunchCount += 1;
    }
}