public void assignChildLayers(Transaction t){
    int layer = PRESERVED_SURFACE_LAYER + 1;
    for (int i = 0; i < mChildren.size(); i++) {
        final WindowState w = mChildren.get(i);
        if (w.mAttrs.type == TYPE_APPLICATION_MEDIA) {
            if (mWinAnimator.hasSurface()) {
                w.assignRelativeLayer(t, mWinAnimator.mSurfaceController.mSurfaceControl, -2);
            } else {
                w.assignLayer(t, -2);
            }
        } else if (w.mAttrs.type == TYPE_APPLICATION_MEDIA_OVERLAY) {
            if (mWinAnimator.hasSurface()) {
                w.assignRelativeLayer(t, mWinAnimator.mSurfaceController.mSurfaceControl, -1);
            } else {
                w.assignLayer(t, -1);
            }
        } else {
            w.assignLayer(t, layer);
        }
        w.assignChildLayers(t);
        layer++;
    }
}