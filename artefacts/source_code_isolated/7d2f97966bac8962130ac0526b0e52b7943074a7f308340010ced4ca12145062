public static String runShellCommandRaw(@NonNull String command){
    UiAutomation automan = InstrumentationRegistry.getInstrumentation().getUiAutomation();
    ParcelFileDescriptor pfd = automan.executeShellCommand(command);
    byte[] buf = new byte[512];
    int bytesRead;
    try (FileInputStream fis = new ParcelFileDescriptor.AutoCloseInputStream(pfd)) {
        StringBuilder stdout = new StringBuilder();
        while ((bytesRead = fis.read(buf)) != -1) {
            stdout.append(new String(buf, 0, bytesRead));
        }
        String result = stdout.toString();
        return TextUtils.isEmpty(result) ? "" : result.trim();
    } catch (Exception e) {
        throw new AndroidRuntimeException("Command '" + command + "' failed: ", e);
    } finally {
        automan.destroy();
    }
}