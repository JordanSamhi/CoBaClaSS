public void testBackupManifest_withSignatures_writesCorrectSignatures() throws Exception{
    PackageInfo packageInfo = createPackageInfo(TEST_PACKAGE, TEST_PACKAGE_INSTALLER, TEST_PACKAGE_VERSION_CODE);
    packageInfo.signingInfo = new SigningInfo(new SigningDetails(new Signature[] { new Signature("1234"), new Signature("5678") }, SigningDetails.SignatureSchemeVersion.SIGNING_BLOCK_V3, null, null));
    File manifestFile = createFile(BACKUP_MANIFEST_FILENAME);
    mBackupWriter.backupManifest(packageInfo, manifestFile, mFilesDir, false);
    byte[] manifestBytes = getWrittenBytes(mBackupDataOutputFile, false);
    String[] manifest = new String(manifestBytes, StandardCharsets.UTF_8).split("\n");
    assertThat(manifest.length).isEqualTo(9);
    assertThat(manifest[6]).isEqualTo("2");
    assertThat(manifest[7]).isEqualTo("1234");
    assertThat(manifest[8]).isEqualTo("5678");
    manifestFile.delete();
}