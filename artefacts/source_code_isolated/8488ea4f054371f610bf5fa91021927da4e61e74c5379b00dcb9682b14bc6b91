public void broadcastWpsFailEvent(String iface, int cfgError, int vendorErrorCode){
    int reason = 0;
    switch(vendorErrorCode) {
        case REASON_TKIP_ONLY_PROHIBITED:
            sendMessage(iface, WPS_FAIL_EVENT, WifiManager.WPS_TKIP_ONLY_PROHIBITED);
            return;
        case REASON_WEP_PROHIBITED:
            sendMessage(iface, WPS_FAIL_EVENT, WifiManager.WPS_WEP_PROHIBITED);
            return;
        default:
            reason = vendorErrorCode;
            break;
    }
    switch(cfgError) {
        case CONFIG_AUTH_FAILURE:
            sendMessage(iface, WPS_FAIL_EVENT, WifiManager.WPS_AUTH_FAILURE);
            return;
        case CONFIG_MULTIPLE_PBC_DETECTED:
            sendMessage(iface, WPS_FAIL_EVENT, WifiManager.WPS_OVERLAP_ERROR);
            return;
        default:
            if (reason == 0) {
                reason = cfgError;
            }
            break;
    }
    sendMessage(iface, WPS_FAIL_EVENT, WifiManager.ERROR, reason);
}