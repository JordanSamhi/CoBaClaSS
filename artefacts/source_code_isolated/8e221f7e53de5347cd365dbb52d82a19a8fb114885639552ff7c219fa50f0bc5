public int[] bucketValues(long[] values){
    Preconditions.checkArgument(values.length == mNumFrequencies);
    int[] buckets = new int[mNumBuckets];
    for (int bucketIdx = 0; bucketIdx < mNumBuckets; bucketIdx++) {
        final int bucketStartIdx = getLowerBound(bucketIdx, mBucketStartIndices);
        final int bucketEndIdx = getUpperBound(bucketIdx, mBucketStartIndices, values.length);
        for (int valuesIdx = bucketStartIdx; valuesIdx < bucketEndIdx; valuesIdx++) {
            buckets[bucketIdx] += values[valuesIdx];
        }
    }
    return buckets;
}