public SecurityEvent redact(int accessingUser){
    final int userId;
    switch(getTag()) {
        case SecurityLog.TAG_ADB_SHELL_CMD:
            return new SecurityEvent(getId(), mEvent.withNewData("").getBytes());
        case SecurityLog.TAG_MEDIA_MOUNT:
        case SecurityLog.TAG_MEDIA_UNMOUNT:
            String mountPoint;
            try {
                mountPoint = getStringData(0);
            } catch (Exception e) {
                return null;
            }
            return new SecurityEvent(getId(), mEvent.withNewData(new Object[] { mountPoint, "" }).getBytes());
        case SecurityLog.TAG_APP_PROCESS_START:
            try {
                userId = UserHandle.getUserId(getIntegerData(2));
            } catch (Exception e) {
                return null;
            }
            break;
        case SecurityLog.TAG_CERT_AUTHORITY_INSTALLED:
        case SecurityLog.TAG_CERT_AUTHORITY_REMOVED:
            try {
                userId = getIntegerData(2);
            } catch (Exception e) {
                return null;
            }
            break;
        case SecurityLog.TAG_KEY_GENERATED:
        case SecurityLog.TAG_KEY_IMPORT:
        case SecurityLog.TAG_KEY_DESTRUCTION:
            try {
                userId = UserHandle.getUserId(getIntegerData(2));
            } catch (Exception e) {
                return null;
            }
            break;
        case SecurityLog.TAG_KEY_INTEGRITY_VIOLATION:
            try {
                userId = UserHandle.getUserId(getIntegerData(1));
            } catch (Exception e) {
                return null;
            }
            break;
        default:
            userId = UserHandle.USER_NULL;
    }
    if (userId == UserHandle.USER_NULL || accessingUser == userId) {
        return this;
    } else {
        return null;
    }
}