public synchronized void onPackageAdded(String packageName, int uid){
    final Boolean permission = highestPermissionForUid(mApps.get(uid), packageName);
    if (permission != mApps.get(uid)) {
        mApps.put(uid, permission);
        Map<Integer, Boolean> apps = new HashMap<>();
        apps.put(uid, permission);
        update(mUsers, apps, true);
    }
    for (Map.Entry<String, Set<UidRange>> vpn : mVpnUidRanges.entrySet()) {
        if (UidRange.containsUid(vpn.getValue(), uid)) {
            final Set<Integer> changedUids = new HashSet<>();
            changedUids.add(uid);
            removeBypassingUids(changedUids, -1);
            updateVpnUids(vpn.getKey(), changedUids, true);
        }
    }
    mAllApps.add(UserHandle.getAppId(uid));
}