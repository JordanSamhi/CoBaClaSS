public void restrictCapabilitesForTestNetwork(int creatorUid){
    final long originalCapabilities = mNetworkCapabilities;
    final long originalTransportTypes = mTransportTypes;
    final NetworkSpecifier originalSpecifier = mNetworkSpecifier;
    final int originalSignalStrength = mSignalStrength;
    final int originalOwnerUid = getOwnerUid();
    final int[] originalAdministratorUids = getAdministratorUids();
    clearAll();
    mTransportTypes = (originalTransportTypes & TEST_NETWORKS_ALLOWED_TRANSPORTS) | (1 << TRANSPORT_TEST);
    mNetworkCapabilities = originalCapabilities & TEST_NETWORKS_ALLOWED_CAPABILITIES;
    mNetworkSpecifier = originalSpecifier;
    mSignalStrength = originalSignalStrength;
    if (originalOwnerUid == creatorUid) {
        setOwnerUid(creatorUid);
    }
    if (ArrayUtils.contains(originalAdministratorUids, creatorUid)) {
        setAdministratorUids(new int[] { creatorUid });
    }
}