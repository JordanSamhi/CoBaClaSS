public void setRecoverySecretTypes(@NonNull @KeyChainProtectionParams.UserSecretType int[] secretTypes) throws RemoteException{
    checkRecoverKeyStorePermission();
    Objects.requireNonNull(secretTypes, "secretTypes is null");
    int userId = UserHandle.getCallingUserId();
    int uid = Binder.getCallingUid();
    int[] currentSecretTypes = mDatabase.getRecoverySecretTypes(userId, uid);
    if (Arrays.equals(secretTypes, currentSecretTypes)) {
        Log.v(TAG, "Not updating secret types - same as old value.");
        return;
    }
    long updatedRows = mDatabase.setRecoverySecretTypes(userId, uid, secretTypes);
    if (updatedRows < 0) {
        throw new ServiceSpecificException(ERROR_SERVICE_INTERNAL_ERROR, "Database error trying to set secret types.");
    }
    if (currentSecretTypes.length == 0) {
        Log.i(TAG, "Initialized secret types.");
        return;
    }
    Log.i(TAG, "Updated secret types. Snapshot pending.");
    if (mDatabase.getSnapshotVersion(userId, uid) != null) {
        mDatabase.setShouldCreateSnapshot(userId, uid, true);
        Log.i(TAG, "Updated secret types. Snapshot must be updated");
    } else {
        Log.i(TAG, "Updated secret types. Snapshot didn't exist");
    }
}