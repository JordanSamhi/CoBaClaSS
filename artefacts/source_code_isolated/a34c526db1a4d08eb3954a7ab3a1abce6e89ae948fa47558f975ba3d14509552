public boolean updateMaxRows(int allowedHeight, int tilesCount){
    final int availableHeight = allowedHeight - mCellMarginTop + mCellMarginVertical;
    final int previousRows = mRows;
    mRows = availableHeight / (mCellHeight + mCellMarginVertical);
    if (mRows < mMinRows) {
        mRows = mMinRows;
    } else if (mRows >= mMaxAllowedRows) {
        mRows = mMaxAllowedRows;
    }
    if (mRows > (tilesCount + mColumns - 1) / mColumns) {
        mRows = (tilesCount + mColumns - 1) / mColumns;
    }
    return previousRows != mRows;
}