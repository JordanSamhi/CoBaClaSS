public static BluetoothDeviceLayerDrawable createLayerDrawable(Context context, int resId, int batteryLevel, float iconScale){
    final Drawable deviceDrawable = context.getDrawable(resId);
    final BatteryMeterDrawable batteryDrawable = new BatteryMeterDrawable(context, context.getColor(R.color.meter_background_color), batteryLevel);
    final int pad = context.getResources().getDimensionPixelSize(R.dimen.bt_battery_padding);
    batteryDrawable.setPadding(pad, pad, pad, pad);
    final BluetoothDeviceLayerDrawable drawable = new BluetoothDeviceLayerDrawable(new Drawable[] { deviceDrawable, batteryDrawable });
    drawable.setLayerGravity(0, Gravity.START);
    drawable.setLayerInsetStart(1, deviceDrawable.getIntrinsicWidth());
    drawable.setLayerInsetTop(1, (int) (deviceDrawable.getIntrinsicHeight() * (1 - iconScale)));
    drawable.setConstantState(context, resId, batteryLevel, iconScale);
    return drawable;
}