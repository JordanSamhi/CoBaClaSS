public List<MediaSessionRecord> getPriorityList(boolean activeOnly, int userId){
    List<MediaSessionRecord> result = new ArrayList<MediaSessionRecord>();
    int lastPlaybackActiveIndex = 0;
    int lastActiveIndex = 0;
    for (MediaSessionRecordImpl record : mSessions) {
        if (!(record instanceof MediaSessionRecord)) {
            continue;
        }
        final MediaSessionRecord session = (MediaSessionRecord) record;
        if ((userId != UserHandle.USER_ALL && userId != session.getUserId())) {
            continue;
        }
        if (!session.isActive()) {
            if (!activeOnly) {
                result.add(session);
            }
            continue;
        }
        if (session.checkPlaybackActiveState(true)) {
            result.add(lastPlaybackActiveIndex++, session);
            lastActiveIndex++;
        } else {
            result.add(lastActiveIndex++, session);
        }
    }
    return result;
}