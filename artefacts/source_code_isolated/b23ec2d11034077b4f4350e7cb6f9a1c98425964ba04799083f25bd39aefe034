public final void queueInputBuffer(int index, int offset, int size, long presentationTimeUs, int flags) throws CryptoException{
    synchronized (mBufferLock) {
        if (mBufferMode == BUFFER_MODE_BLOCK) {
            throw new IncompatibleWithBlockModelException("queueInputBuffer() " + "is not compatible with CONFIGURE_FLAG_USE_BLOCK_MODEL. " + "Please use getQueueRequest() to queue buffers");
        }
        invalidateByteBuffer(mCachedInputBuffers, index);
        mDequeuedInputBuffers.remove(index);
    }
    try {
        native_queueInputBuffer(index, offset, size, presentationTimeUs, flags);
    } catch (CryptoException | IllegalStateException e) {
        revalidateByteBuffer(mCachedInputBuffers, index);
        throw e;
    }
}