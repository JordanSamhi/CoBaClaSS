public static List<Signature> getSignatures(PackageInfo packageInfo){
    Signature[] signatures = packageInfo.signatures;
    SigningInfo signingInfo = packageInfo.signingInfo;
    if (signingInfo != null) {
        signatures = signingInfo.getSigningCertificateHistory();
        if (signingInfo.hasMultipleSigners()) {
            signatures = signingInfo.getApkContentsSigners();
        }
    }
    return (signatures == null) ? Collections.EMPTY_LIST : Arrays.asList(signatures);
}