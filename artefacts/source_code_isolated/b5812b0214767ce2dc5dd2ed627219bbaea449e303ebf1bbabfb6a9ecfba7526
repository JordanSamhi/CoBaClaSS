public static File getFile(FileDescriptor fd) throws IOException{
    try {
        final String path = Os.readlink("/proc/self/fd/" + fd.getInt$());
        if (OsConstants.S_ISREG(Os.stat(path).st_mode) || OsConstants.S_ISCHR(Os.stat(path).st_mode)) {
            return new File(path);
        } else {
            throw new IOException("Not a regular file or character device: " + path);
        }
    } catch (ErrnoException e) {
        throw e.rethrowAsIOException();
    }
}