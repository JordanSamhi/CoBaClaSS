public void takeEmergencyCallAction(){
    MetricsLogger.action(mContext, MetricsEvent.ACTION_EMERGENCY_CALL);
    if (mPowerManager != null) {
        mPowerManager.userActivity(SystemClock.uptimeMillis(), true);
    }
    try {
        ActivityTaskManager.getService().stopSystemLockTaskMode();
    } catch (RemoteException e) {
        Slog.w(LOG_TAG, "Failed to stop app pinning");
    }
    if (isInCall()) {
        resumeCall();
        if (mEmergencyButtonCallback != null) {
            mEmergencyButtonCallback.onEmergencyButtonClickedWhenInCall();
        }
    } else {
        KeyguardUpdateMonitor updateMonitor = Dependency.get(KeyguardUpdateMonitor.class);
        if (updateMonitor != null) {
            updateMonitor.reportEmergencyCallAction(true);
        } else {
            Log.w(LOG_TAG, "KeyguardUpdateMonitor was null, launching intent anyway.");
        }
        TelecomManager telecomManager = getTelecommManager();
        if (telecomManager == null) {
            Log.wtf(LOG_TAG, "TelecomManager was null, cannot launch emergency dialer");
            return;
        }
        Intent emergencyDialIntent = telecomManager.createLaunchEmergencyDialerIntent(null).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS | Intent.FLAG_ACTIVITY_CLEAR_TOP).putExtra(EmergencyDialerConstants.EXTRA_ENTRY_TYPE, EmergencyDialerConstants.ENTRY_TYPE_LOCKSCREEN_BUTTON);
        getContext().startActivityAsUser(emergencyDialIntent, ActivityOptions.makeCustomAnimation(getContext(), 0, 0).toBundle(), new UserHandle(KeyguardUpdateMonitor.getCurrentUser()));
    }
}