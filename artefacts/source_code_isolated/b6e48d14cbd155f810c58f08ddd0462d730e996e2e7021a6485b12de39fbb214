public List<AppWidgetProviderInfo> getInstalledProvidersForProfile(int categoryFilter, @Nullable UserHandle profile, @Nullable String packageName){
    if (mService == null) {
        return Collections.emptyList();
    }
    if (profile == null) {
        profile = mContext.getUser();
    }
    try {
        ParceledListSlice<AppWidgetProviderInfo> providers = mService.getInstalledProvidersForProfile(categoryFilter, profile.getIdentifier(), packageName);
        if (providers == null) {
            return Collections.emptyList();
        }
        for (AppWidgetProviderInfo info : providers.getList()) {
            info.updateDimensions(mDisplayMetrics);
        }
        return providers.getList();
    } catch (RemoteException e) {
        throw e.rethrowFromSystemServer();
    }
}