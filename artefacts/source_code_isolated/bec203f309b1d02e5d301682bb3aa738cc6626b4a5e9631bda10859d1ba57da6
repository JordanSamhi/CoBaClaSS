public List<byte[]> getInstalledCaCerts(@Nullable ComponentName admin){
    final List<byte[]> certs = new ArrayList<byte[]>();
    throwIfParentInstance("getInstalledCaCerts");
    if (mService != null) {
        try {
            mService.enforceCanManageCaCerts(admin, mContext.getPackageName());
            final TrustedCertificateStore certStore = new TrustedCertificateStore();
            for (String alias : certStore.userAliases()) {
                try {
                    certs.add(certStore.getCertificate(alias).getEncoded());
                } catch (CertificateException ce) {
                    Log.w(TAG, "Could not encode certificate: " + alias, ce);
                }
            }
        } catch (RemoteException re) {
            throw re.rethrowFromSystemServer();
        }
    }
    return certs;
}