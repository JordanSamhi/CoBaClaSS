public final void init(int opmode, Key key, SecureRandom random) throws InvalidKeyException{
    initialized = false;
    checkOpmode(opmode);
    try {
        chooseProvider(InitType.KEY, opmode, key, null, null, random);
    } catch (InvalidAlgorithmParameterException e) {
        throw new InvalidKeyException(e);
    }
    initialized = true;
    this.opmode = opmode;
}