public void writeRawBuffer(byte[] val, int offset, int length){
    if (val == null) {
        return;
    }
    int amt = length < (mChunkSize - mWriteIndex) ? length : (mChunkSize - mWriteIndex);
    if (amt > 0) {
        System.arraycopy(val, offset, mWriteBuffer, mWriteIndex, amt);
        mWriteIndex += amt;
        length -= amt;
        offset += amt;
    }
    while (length > 0) {
        nextWriteBuffer();
        amt = length < mChunkSize ? length : mChunkSize;
        System.arraycopy(val, offset, mWriteBuffer, mWriteIndex, amt);
        mWriteIndex += amt;
        length -= amt;
        offset += amt;
    }
}