public void startLegacyVpn(VpnProfile profile){
    int user = UserHandle.getUserId(Binder.getCallingUid());
    final LinkProperties egress = getActiveLinkProperties();
    if (egress == null) {
        throw new IllegalStateException("Missing active network connection");
    }
    synchronized (mVpns) {
        throwIfLockdownEnabled();
        mVpns.get(user).startLegacyVpn(profile, mKeyStore, egress);
    }
}