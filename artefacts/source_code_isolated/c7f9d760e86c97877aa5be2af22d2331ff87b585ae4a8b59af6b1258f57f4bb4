public void setSessionToken(final MediaSession.Token token){
    if (token == null) {
        throw new IllegalArgumentException("Session token may not be null.");
    }
    if (mSession != null) {
        throw new IllegalStateException("The session token has already been set.");
    }
    mSession = token;
    mHandler.post(new Runnable() {

        @Override
        public void run() {
            Iterator<ConnectionRecord> iter = mConnections.values().iterator();
            while (iter.hasNext()) {
                ConnectionRecord connection = iter.next();
                try {
                    connection.callbacks.onConnect(connection.root.getRootId(), token, connection.root.getExtras());
                } catch (RemoteException e) {
                    Log.w(TAG, "Connection for " + connection.pkg + " is no longer valid.");
                    iter.remove();
                }
            }
        }
    });
}