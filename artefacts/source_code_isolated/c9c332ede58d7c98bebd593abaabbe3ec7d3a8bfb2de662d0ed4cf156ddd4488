public Pair<Class, Object> unpack(ByteBuffer buffer){
    int dataType = buffer.getInt();
    DataPackage dataPackage = DATA_PACKAGES.get(dataType);
    if (dataPackage == null) {
        Log.e(TAG, "Cannot find DataPackage for type:" + dataType);
        return null;
    }
    int dataSize = buffer.getInt();
    int position = buffer.position();
    Object obj = dataPackage.unpack(buffer);
    if (buffer.position() - position != dataSize) {
        Log.e(TAG, "Broken data package");
        return null;
    }
    return new Pair<Class, Object>(dataPackage.getMyType(), obj);
}