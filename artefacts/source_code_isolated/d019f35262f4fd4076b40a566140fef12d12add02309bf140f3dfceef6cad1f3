public AutofillManager.AutofillClient getAutofillClient(){
    final AutofillManager.AutofillClient client = super.getAutofillClient();
    if (client != null) {
        return client;
    }
    if (android.view.autofill.Helper.sVerbose) {
        Log.v(TAG, "getAutofillClient(): null on super, trying to find activity thread");
    }
    final ActivityThread activityThread = ActivityThread.currentActivityThread();
    if (activityThread == null) {
        return null;
    }
    final int activityCount = activityThread.mActivities.size();
    for (int i = 0; i < activityCount; i++) {
        final ActivityThread.ActivityClientRecord record = activityThread.mActivities.valueAt(i);
        if (record == null) {
            continue;
        }
        final Activity activity = record.activity;
        if (activity == null) {
            continue;
        }
        if (activity.getWindow().getDecorView().hasFocus()) {
            if (android.view.autofill.Helper.sVerbose) {
                Log.v(TAG, "getAutofillClient(): found activity for " + this + ": " + activity);
            }
            return activity;
        }
    }
    if (android.view.autofill.Helper.sVerbose) {
        Log.v(TAG, "getAutofillClient(): none of the " + activityCount + " activities on " + this + " have focus");
    }
    return null;
}