public void setCaCertificate(@Nullable X509Certificate cert){
    if (cert != null) {
        if (cert.getBasicConstraints() >= 0) {
            mIsAppInstalledCaCert = true;
            mCaCerts = new X509Certificate[] { cert };
        } else {
            mCaCerts = null;
            throw new IllegalArgumentException("Not a CA certificate");
        }
    } else {
        mCaCerts = null;
    }
}