public int getA11yButtonState(@Nullable boolean[] outFeedbackEnabled){
    boolean feedbackEnabled = false;
    final List<AccessibilityServiceInfo> services = mAccessibilityManager.getEnabledAccessibilityServiceList(AccessibilityServiceInfo.FEEDBACK_ALL_MASK);
    final List<String> a11yButtonTargets = mAccessibilityManager.getAccessibilityShortcutTargets(AccessibilityManager.ACCESSIBILITY_BUTTON);
    final int requestingServices = a11yButtonTargets.size();
    for (int i = services.size() - 1; i >= 0; --i) {
        AccessibilityServiceInfo info = services.get(i);
        if (info.feedbackType != 0 && info.feedbackType != AccessibilityServiceInfo.FEEDBACK_GENERIC) {
            feedbackEnabled = true;
        }
    }
    if (outFeedbackEnabled != null) {
        outFeedbackEnabled[0] = feedbackEnabled;
    }
    return (requestingServices >= 1 ? SYSUI_STATE_A11Y_BUTTON_CLICKABLE : 0) | (requestingServices >= 2 ? SYSUI_STATE_A11Y_BUTTON_LONG_CLICKABLE : 0);
}