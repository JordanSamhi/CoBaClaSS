public final void init(int opmode, Key key, AlgorithmParameters params, SecureRandom random) throws InvalidKeyException, InvalidAlgorithmParameterException{
    initialized = false;
    checkOpmode(opmode);
    chooseProvider(InitType.ALGORITHM_PARAMS, opmode, key, null, params, random);
    initialized = true;
    this.opmode = opmode;
}