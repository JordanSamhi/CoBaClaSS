public static Map<String, byte[]> encryptKeysWithRecoveryKey(SecretKey recoveryKey, Map<String, Pair<SecretKey, byte[]>> keys) throws NoSuchAlgorithmException, InvalidKeyException{
    HashMap<String, byte[]> encryptedKeys = new HashMap<>();
    for (String alias : keys.keySet()) {
        SecretKey key = keys.get(alias).first;
        byte[] metadata = keys.get(alias).second;
        byte[] header;
        if (metadata == null) {
            header = ENCRYPTED_APPLICATION_KEY_HEADER;
        } else {
            header = concat(ENCRYPTED_APPLICATION_KEY_HEADER, metadata);
        }
        byte[] encryptedKey = SecureBox.encrypt(null, recoveryKey.getEncoded(), header, key.getEncoded());
        encryptedKeys.put(alias, encryptedKey);
    }
    return encryptedKeys;
}