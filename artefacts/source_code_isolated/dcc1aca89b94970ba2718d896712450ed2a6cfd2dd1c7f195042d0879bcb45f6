public String renameDocument(String docId, String displayName) throws FileNotFoundException{
    displayName = FileUtils.buildValidFatFilename(displayName);
    final File before = getFileForDocId(docId);
    final File beforeVisibleFile = getFileForDocId(docId, true);
    final File after = FileUtils.buildUniqueFile(before.getParentFile(), displayName);
    if (!before.renameTo(after)) {
        throw new IllegalStateException("Failed to rename to " + after);
    }
    final String afterDocId = getDocIdForFile(after);
    onDocIdChanged(docId);
    onDocIdChanged(afterDocId);
    final File afterVisibleFile = getFileForDocId(afterDocId, true);
    moveInMediaStore(beforeVisibleFile, afterVisibleFile);
    if (!TextUtils.equals(docId, afterDocId)) {
        return afterDocId;
    } else {
        return null;
    }
}