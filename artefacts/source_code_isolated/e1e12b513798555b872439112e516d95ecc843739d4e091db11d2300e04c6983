public static short halfToShortBits(@HalfFloat short h){
    return (h & FP16.EXPONENT_SIGNIFICAND_MASK) > FP16.POSITIVE_INFINITY ? NaN : h;
}