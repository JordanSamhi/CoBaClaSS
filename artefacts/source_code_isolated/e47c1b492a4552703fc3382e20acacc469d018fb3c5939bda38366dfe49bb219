public static void makeDirRecursive(File targetDir, int mode) throws ErrnoException{
    final Path targetDirPath = targetDir.toPath();
    final int directoriesCount = targetDirPath.getNameCount();
    File currentDir;
    for (int i = 1; i <= directoriesCount; i++) {
        currentDir = targetDirPath.subpath(0, i).toFile();
        if (currentDir.exists()) {
            continue;
        }
        Os.mkdir(currentDir.getAbsolutePath(), mode);
        Os.chmod(currentDir.getAbsolutePath(), mode);
    }
}