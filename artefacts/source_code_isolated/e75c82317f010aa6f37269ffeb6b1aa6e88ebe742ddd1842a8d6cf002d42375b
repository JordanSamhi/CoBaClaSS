public static byte[] generateApkVerity(String apkPath, ByteBufferFactory bufferFactory) throws IOException, SignatureNotFoundException, SecurityException, DigestException, NoSuchAlgorithmException{
    try {
        return ApkSignatureSchemeV3Verifier.generateApkVerity(apkPath, bufferFactory);
    } catch (SignatureNotFoundException e) {
    }
    return ApkSignatureSchemeV2Verifier.generateApkVerity(apkPath, bufferFactory);
}