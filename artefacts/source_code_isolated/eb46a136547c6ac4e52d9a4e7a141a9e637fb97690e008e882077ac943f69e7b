public List<WifiConfiguration> retrieveConfigurationsFromBackupData(byte[] data){
    if (data == null || data.length == 0) {
        Log.e(TAG, "Invalid backup data received");
        return null;
    }
    try {
        if (mVerboseLoggingEnabled) {
            mDebugLastBackupDataRestored = data;
        }
        final XmlPullParser in = Xml.newPullParser();
        ByteArrayInputStream inputStream = new ByteArrayInputStream(data);
        in.setInput(inputStream, StandardCharsets.UTF_8.name());
        XmlUtil.gotoDocumentStart(in, XML_TAG_DOCUMENT_HEADER);
        int rootTagDepth = in.getDepth();
        int majorVersion = -1;
        int minorVersion = -1;
        try {
            float version = (float) XmlUtil.readNextValueWithName(in, XML_TAG_VERSION);
            String versionStr = new Float(version).toString();
            int separatorPos = versionStr.indexOf('.');
            if (separatorPos == -1) {
                majorVersion = Integer.parseInt(versionStr);
                minorVersion = 0;
            } else {
                majorVersion = Integer.parseInt(versionStr.substring(0, separatorPos));
                minorVersion = Integer.parseInt(versionStr.substring(separatorPos + 1));
            }
        } catch (ClassCastException cce) {
            majorVersion = 1;
            minorVersion = 0;
        }
        Log.d(TAG, "Version of backup data - major: " + majorVersion + "; minor: " + minorVersion);
        WifiBackupDataParser parser = getWifiBackupDataParser(majorVersion);
        if (parser == null) {
            Log.w(TAG, "Major version of backup data is unknown to this Android" + " version; not restoring");
            return null;
        } else {
            return parser.parseNetworkConfigurationsFromXml(in, rootTagDepth, minorVersion);
        }
    } catch (XmlPullParserException | IOException | ClassCastException | IllegalArgumentException e) {
        Log.e(TAG, "Error parsing the backup data: " + e);
    }
    return null;
}