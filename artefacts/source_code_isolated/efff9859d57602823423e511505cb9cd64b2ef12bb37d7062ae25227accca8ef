public final int genExemptionBlob(byte[] output) throws IllegalStateException, ShortBufferException, ExemptionMechanismException{
    if (!initialized) {
        throw new IllegalStateException("ExemptionMechanism not initialized");
    }
    int n = exmechSpi.engineGenExemptionBlob(output, 0);
    done = true;
    return n;
}