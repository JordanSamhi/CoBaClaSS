public List<NetworkEvent> retrieveNetworkLogs(@Nullable ComponentName admin, @NonNull String packageName, long batchToken){
    if (!mHasFeature) {
        return null;
    }
    enforceCanManageScope(admin, packageName, DeviceAdminInfo.USES_POLICY_DEVICE_OWNER, DELEGATION_NETWORK_LOGGING);
    ensureAllUsersAffiliated();
    synchronized (getLockObject()) {
        if (mNetworkLogger == null || !isNetworkLoggingEnabledInternalLocked()) {
            return null;
        }
        final boolean isDelegate = (admin == null);
        DevicePolicyEventLogger.createEvent(DevicePolicyEnums.RETRIEVE_NETWORK_LOGS).setAdmin(packageName).setBoolean(isDelegate).write();
        final long currentTime = System.currentTimeMillis();
        DevicePolicyData policyData = getUserData(UserHandle.USER_SYSTEM);
        if (currentTime > policyData.mLastNetworkLogsRetrievalTime) {
            policyData.mLastNetworkLogsRetrievalTime = currentTime;
            saveSettingsLocked(UserHandle.USER_SYSTEM);
        }
        return mNetworkLogger.retrieveLogs(batchToken);
    }
}