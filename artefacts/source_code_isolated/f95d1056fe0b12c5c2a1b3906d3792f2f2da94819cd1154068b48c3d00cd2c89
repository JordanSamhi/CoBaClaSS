public static Bitmap bundleToHardwareBitmap(Bundle bundle){
    if (!bundle.containsKey(KEY_BUFFER) || !bundle.containsKey(KEY_COLOR_SPACE)) {
        throw new IllegalArgumentException("Bundle does not contain a hardware bitmap");
    }
    HardwareBuffer buffer = bundle.getParcelable(KEY_BUFFER);
    ParcelableColorSpace colorSpace = bundle.getParcelable(KEY_COLOR_SPACE);
    return Bitmap.wrapHardwareBuffer(Objects.requireNonNull(buffer), colorSpace);
}