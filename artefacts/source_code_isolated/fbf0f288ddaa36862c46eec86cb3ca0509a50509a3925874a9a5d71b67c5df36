public void dumpProfiles(AndroidPackage pkg){
    final int sharedGid = UserHandle.getSharedAppGid(pkg.getUid());
    try {
        ArrayMap<String, String> packageProfileNames = getPackageProfileNames(pkg);
        for (int i = packageProfileNames.size() - 1; i >= 0; i--) {
            String codePath = packageProfileNames.keyAt(i);
            String profileName = packageProfileNames.valueAt(i);
            synchronized (mInstallLock) {
                mInstaller.dumpProfiles(sharedGid, pkg.getPackageName(), profileName, codePath);
            }
        }
    } catch (InstallerException e) {
        Slog.w(TAG, "Failed to dump profiles", e);
    }
}